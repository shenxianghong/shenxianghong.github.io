<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>ã€Œ Kata Containers ã€å¿«é€Ÿå¼€å§‹ - ğŸ¾Corgi</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="ğŸ¾Corgi"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="ğŸ¾Corgi"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Kata Containers åœ¨ Kubernetes é›†ç¾¤åœºæ™¯ä¸­çš„é…ç½®ä¸åŸºç¡€ä½¿ç”¨ç¤ºä¾‹"><meta property="og:type" content="blog"><meta property="og:title" content="ã€Œ Kata Containers ã€å¿«é€Ÿå¼€å§‹"><meta property="og:url" content="http://shenxianghong.github.io/2021/04/15/2021-04-15%20Kata%20Containers%20%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/"><meta property="og:site_name" content="ğŸ¾Corgi"><meta property="og:description" content="Kata Containers åœ¨ Kubernetes é›†ç¾¤åœºæ™¯ä¸­çš„é…ç½®ä¸åŸºç¡€ä½¿ç”¨ç¤ºä¾‹"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://picsum.photos/0?sig=20210415"><meta property="article:published_time" content="2021-04-14T16:00:00.000Z"><meta property="article:modified_time" content="2023-06-19T01:18:07.016Z"><meta property="article:author" content="Shen Xianghong"><meta property="article:tag" content="Kata Containers"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://picsum.photos/0?sig=20210415"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://shenxianghong.github.io/2021/04/15/2021-04-15%20Kata%20Containers%20%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/"},"headline":"ã€Œ Kata Containers ã€å¿«é€Ÿå¼€å§‹","image":[],"datePublished":"2021-04-14T16:00:00.000Z","dateModified":"2023-06-19T01:18:07.016Z","author":{"@type":"Person","name":"Shen Xianghong"},"publisher":{"@type":"Organization","name":"ğŸ¾Corgi","logo":{"@type":"ImageObject","url":"http://shenxianghong.github.io/img/logo.svg"}},"description":"Kata Containers åœ¨ Kubernetes é›†ç¾¤åœºæ™¯ä¸­çš„é…ç½®ä¸åŸºç¡€ä½¿ç”¨ç¤ºä¾‹"}</script><link rel="canonical" href="http://shenxianghong.github.io/2021/04/15/2021-04-15%20Kata%20Containers%20%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/"><link rel="alternate" href="/atom.xml" title="ğŸ¾Corgi" type="application/atom+xml"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/xcode.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="ğŸ¾Corgi" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a></div><div class="navbar-end"><a class="navbar-item night" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="https://picsum.photos/0?sig=20210415" alt="ã€Œ Kata Containers ã€å¿«é€Ÿå¼€å§‹"></span></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="fa fa-calendar"></i>Â <time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2021-04-15</time></span><span class="level-item"><i class="fa fa-calendar-check"></i>Â <time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2023-06-19</time></span><span class="level-item"><i class="far fa-folder-open"></i>Â <a class="link-muted" href="/categories/Container-Runtime/">Container Runtime</a></span><span class="level-item"><i class="far fa-clock"></i>Â an hour read (About 9435 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">ã€Œ Kata Containers ã€å¿«é€Ÿå¼€å§‹</h1><div class="content"><div align=center><img width="200" style="border: 0px" src="/gallery/kata-containers/logo.svg"></div>

<hr>
<blockquote>
<p>based on <strong>3.0.0</strong></p>
</blockquote>
<h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><p>Kata Containers ç¤¾åŒºæä¾›äº† x86 æ¶æ„åˆ¶å“ï¼Œarm64 æ¶æ„åˆ¶å“éœ€è¦æ‰‹åŠ¨ç¼–è¯‘ã€‚è¿™é‡Œä»¥ x86 æ¶æ„çš„ç¤¾åŒºåˆ¶å“å®‰è£…ä¸ºä¾‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">wget https://github.com/kata-containers/kata-containers/releases/download/3.0.0/kata-static-3.0.0-x86_64.tar.xz</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tar -xvf kata-static-3.0.0-x86_64.tar.xz</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tree opt/kata/</span></span><br><span class="line">opt/kata/</span><br><span class="line">â”œâ”€â”€ bin # å¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸è„šæœ¬</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ cloud-hypervisor</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ containerd-shim-kata-v2</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ firecracker</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ jailer</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ kata-collect-data.sh</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ kata-monitor</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ kata-runtime</span><br><span class="line">â”‚Â Â  â””â”€â”€ qemu-system-x86_64</span><br><span class="line">â”œâ”€â”€ libexec # å¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶</span><br><span class="line">â”‚Â Â  â””â”€â”€ virtiofsd</span><br><span class="line">â”œâ”€â”€ runtime-rs # Rust å®ç°ä¸‹çš„ shimv2</span><br><span class="line">â”‚Â Â  â””â”€â”€ bin</span><br><span class="line">â”‚Â Â      â””â”€â”€ containerd-shim-kata-v2</span><br><span class="line">â””â”€â”€ share</span><br><span class="line">    â”œâ”€â”€ bash-completion # å‘½ä»¤è¡Œè¡¥å…¨è„šæœ¬</span><br><span class="line">    â”‚Â Â  â””â”€â”€ completions</span><br><span class="line">    â”‚Â Â      â””â”€â”€ kata-runtime</span><br><span class="line">    â”œâ”€â”€ defaults # ä¸åŒ hypervisor å®ç°ä¸‹çš„é™æ€é…ç½®æ–‡ä»¶</span><br><span class="line">    â”‚Â Â  â””â”€â”€ kata-containers</span><br><span class="line">    â”‚Â Â      â”œâ”€â”€ configuration-acrn.toml</span><br><span class="line">    â”‚Â Â      â”œâ”€â”€ configuration-clh.toml</span><br><span class="line">    â”‚Â Â      â”œâ”€â”€ configuration-dragonball.toml</span><br><span class="line">    â”‚Â Â      â”œâ”€â”€ configuration-fc.toml</span><br><span class="line">    â”‚Â Â      â”œâ”€â”€ configuration-qemu.toml</span><br><span class="line">    â”‚Â Â      â””â”€â”€ configuration.toml -&gt; configuration-qemu.toml</span><br><span class="line">    â”œâ”€â”€ kata-containers # å†…æ ¸ä¸ guest é•œåƒ</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ config-5.19.2</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ kata-alpine-3.15.initrd</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ kata-clearlinux-latest.image</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ kata-containers.img -&gt; kata-clearlinux-latest.image</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ kata-containers-initrd.img -&gt; kata-alpine-3.15.initrd</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ vmlinux-5.19.2-96</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ vmlinux.container -&gt; vmlinux-5.19.2-96</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ vmlinuz-5.19.2-96</span><br><span class="line">    â”‚Â Â  â””â”€â”€ vmlinuz.container -&gt; vmlinuz-5.19.2-96</span><br><span class="line">    â””â”€â”€ kata-qemu # QEMU ä¾èµ–</span><br><span class="line">        â””â”€â”€ qemu</span><br><span class="line">            â”œâ”€â”€ bios-256k.bin</span><br><span class="line">            â”œâ”€â”€ bios.bin</span><br><span class="line">            â”œâ”€â”€ bios-microvm.bin</span><br><span class="line">            â”œâ”€â”€ edk2-aarch64-code.fd</span><br><span class="line">            â”œâ”€â”€ edk2-arm-code.fd</span><br><span class="line">            â”œâ”€â”€ edk2-arm-vars.fd</span><br><span class="line">            â”œâ”€â”€ edk2-i386-code.fd</span><br><span class="line">            â”œâ”€â”€ edk2-i386-secure-code.fd</span><br><span class="line">            â”œâ”€â”€ edk2-i386-vars.fd</span><br><span class="line">            â”œâ”€â”€ edk2-licenses.txt</span><br><span class="line">            â”œâ”€â”€ edk2-x86_64-code.fd</span><br><span class="line">            â”œâ”€â”€ edk2-x86_64-secure-code.fd</span><br><span class="line">            â”œâ”€â”€ efi-virtio.rom</span><br><span class="line">            â”œâ”€â”€ firmware</span><br><span class="line">            â”‚Â Â  â”œâ”€â”€ 50-edk2-i386-secure.json</span><br><span class="line">            â”‚Â Â  â”œâ”€â”€ 50-edk2-x86_64-secure.json</span><br><span class="line">            â”‚Â Â  â”œâ”€â”€ 60-edk2-aarch64.json</span><br><span class="line">            â”‚Â Â  â”œâ”€â”€ 60-edk2-arm.json</span><br><span class="line">            â”‚Â Â  â”œâ”€â”€ 60-edk2-i386.json</span><br><span class="line">            â”‚Â Â  â””â”€â”€ 60-edk2-x86_64.json</span><br><span class="line">            â”œâ”€â”€ hppa-firmware.img</span><br><span class="line">            â”œâ”€â”€ kvmvapic.bin</span><br><span class="line">            â”œâ”€â”€ linuxboot.bin</span><br><span class="line">            â”œâ”€â”€ linuxboot_dma.bin</span><br><span class="line">            â”œâ”€â”€ multiboot_dma.bin</span><br><span class="line">            â”œâ”€â”€ pvh.bin</span><br><span class="line">            â”œâ”€â”€ qboot.rom</span><br><span class="line">            â”œâ”€â”€ qemu-nsis.bmp</span><br><span class="line">            â”œâ”€â”€ s390-ccw.img</span><br><span class="line">            â””â”€â”€ s390-netboot.img</span><br></pre></td></tr></table></figure>

<h1 id="é…ç½®å‚æ•°"><a href="#é…ç½®å‚æ•°" class="headerlink" title="é…ç½®å‚æ•°"></a>é…ç½®å‚æ•°</h1><p>Kata Containers ä¸­é…ç½®çš„ä¼˜å…ˆçº§ä¸ºï¼šåŠ¨æ€é…ç½®é¡¹ &gt; é™æ€é…ç½®é¡¹ &gt; é»˜è®¤å€¼</p>
<ul>
<li>åŠ¨æ€é…ç½®é¡¹æ˜¯é€šè¿‡ OCI spec ä¸­çš„ annotations ä¼ é€’ï¼Œä¸»æµçš„ Container Engine å‡å®ç°æ”¯æŒå°†å®¹å™¨ annotations é€ä¼ è‡³ Kata è¿è¡Œæ—¶</li>
<li>å„ä¸ªåŠ¨æ€ä¸é™æ€é…ç½®é¡¹æ”¯æŒä¸å¦è§† hypervisor å…·ä½“å®ç°çš„èƒ½åŠ›æœ‰æ‰€åŒºåˆ«</li>
</ul>
<h2 id="hypervisor"><a href="#hypervisor" class="headerlink" title="hypervisor"></a>hypervisor</h2><p>åŠ¨æ€é…ç½®é¡¹çš„å‰ç¼€ä¸º io.katacontainers.hypervisor.&lt;é™æ€é…ç½®é¡¹&gt;</p>
<h3 id="QEMU"><a href="#QEMU" class="headerlink" title="QEMU"></a>QEMU</h3><table>
<thead>
<tr>
<th>é™æ€é…ç½®é¡¹</th>
<th>åŠ¨æ€é…ç½®</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>path</td>
<td>Y</td>
<td>hypervisor å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„</td>
</tr>
<tr>
<td>kernel</td>
<td>Y</td>
<td>VM å†…æ ¸è·¯å¾„</td>
</tr>
<tr>
<td>image</td>
<td>Y</td>
<td>VM rootfs é•œåƒè·¯å¾„ï¼Œä¸ initrd æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª</td>
</tr>
<tr>
<td>initrd</td>
<td>Y</td>
<td>VM rootfs é•œåƒè·¯å¾„ï¼Œä¸ image æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª</td>
</tr>
<tr>
<td>machine_type</td>
<td>Y</td>
<td>QEMU æœºå™¨ç±»å‹ï¼Œä¾‹å¦‚ amd64 æ¶æ„ä¸‹ä¸º q35ã€arm64 æ¶æ„ä¸‹ä¸º virt</td>
</tr>
<tr>
<td>confidential_guest</td>
<td>N</td>
<td>æ˜¯å¦å¯ç”¨æœºå¯†å®¹å™¨ç‰¹æ€§ã€‚æœºå¯†å®¹å™¨éœ€è¦ host æ”¯æŒ tdxProtectionï¼ˆ<a target="_blank" rel="noopener" href="https://software.intel.com/content/www/us/en/develop/articles/intel-trust-domain-extensions.html">Intel Trust Domain Extensions</a>ï¼‰ã€sevProtectionï¼ˆ<a target="_blank" rel="noopener" href="https://developer.amd.com/sev/">AMD Secure Encrypted Virtualization</a>ï¼‰ã€pefProtectionï¼ˆ<a target="_blank" rel="noopener" href="https://www.kernel.org/doc/html/latest/powerpc/ultravisor.html">IBM POWER 9 Protected Execution Facility</a>ï¼‰ä»¥åŠ seProtectionï¼ˆ<a target="_blank" rel="noopener" href="https://www.kernel.org/doc/html/latest/virt/kvm/s390-pv.html">IBM Secure Execution (IBM Z &amp; LinuxONE)</a>ï¼‰ã€‚ä¸æ”¯æŒ CPU å’Œå†…å­˜çš„çƒ­æ’æ‹”ä»¥åŠ NVDIMM è®¾å¤‡ï¼Œä¸æ”¯æŒ arm64 æ¶æ„</td>
</tr>
<tr>
<td>rootless</td>
<td>Y</td>
<td>æ˜¯å¦ä»¥é root æƒé™çš„éšæœºç”¨æˆ·å¯åŠ¨ QEMU VMMï¼Œé»˜è®¤ä¸º false</td>
</tr>
<tr>
<td>enable_annotations</td>
<td>N</td>
<td>å…è®¸ hypervisor åŠ¨æ€é…ç½®çš„é…ç½®é¡¹</td>
</tr>
<tr>
<td>valid_hypervisor_paths</td>
<td>N</td>
<td>ä»¥ glob(3) è§„åˆ™æ ¡éªŒ path å‚æ•°æ˜¯å¦ä¸ºåˆæ³•çš„è·¯å¾„é›†åˆ</td>
</tr>
<tr>
<td>kernel_params</td>
<td>Y</td>
<td>VM kernel çš„é¢å¤–é™„åŠ å‚æ•°ï¼Œé»˜è®¤ä¸ºç©º</td>
</tr>
<tr>
<td>firmware</td>
<td>Y</td>
<td>å›ºä»¶è·¯å¾„ï¼Œé»˜è®¤ä¸ºç©º</td>
</tr>
<tr>
<td>firmware_volume</td>
<td>Y</td>
<td>å›ºä»¶å·è·¯å¾„ï¼Œé»˜è®¤ä¸ºç©º</td>
</tr>
<tr>
<td>machine_accelerators</td>
<td>Y</td>
<td>æœºå™¨åŠ é€Ÿå™¨å‚æ•°ï¼Œé»˜è®¤ä¸ºç©º</td>
</tr>
<tr>
<td>seccompsandbox</td>
<td>N</td>
<td>seccomp å‚æ•°ã€‚QEMU seccomp sandbox æ˜¯ QEMU VM ä¸­çš„ä¸€ç§å®‰å…¨ç‰¹æ€§ï¼Œé€šè¿‡é™åˆ¶ QEMU è¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨ï¼Œä»¥æé«˜ VM çš„å®‰å…¨æ€§ã€‚å®ƒä½¿ç”¨äº† Linux å†…æ ¸æä¾›çš„ seccomp æœºåˆ¶ï¼Œå°† QEMU è¿›ç¨‹é™åˆ¶åœ¨ä¸€ç»„å®‰å…¨çš„ç³»ç»Ÿè°ƒç”¨ä¸­ï¼Œä»è€Œé™ä½ VM é­å—æ”»å‡»çš„é£é™©ã€‚æ¨èè®¾ç½® &#x2F;proc&#x2F;sys&#x2F;net&#x2F;core&#x2F;bpf_jit_enable æ–‡ä»¶å†…å®¹ä¸º 1ï¼Œä»¥é™ä½è¯¥ç‰¹æ€§å¸¦æ¥çš„æ€§èƒ½ä¸‹é™</td>
</tr>
<tr>
<td>cpu_features</td>
<td>Y</td>
<td>CPU ç‰¹æ€§å‚æ•°ï¼Œé»˜è®¤ä¸ºç©º</td>
</tr>
<tr>
<td>default_vcpus</td>
<td>Y</td>
<td>VM é»˜è®¤çš„ CPU æ•°é‡ï¼Œé»˜è®¤ä¸º 1ï¼Œæœ€å¤§ä¸º host CPU æ•°é‡</td>
</tr>
<tr>
<td>default_maxvcpus</td>
<td>Y</td>
<td>VM æœ€å¤§çš„ CPU æ•°é‡ï¼Œé»˜è®¤ä¸º host CPU æ•°é‡ï¼Œå…·ä½“èƒ½å¦ä½¿ç”¨åˆ° host CPU æ•°é‡ï¼Œè¿˜éœ€è¦è§† hypervisor é™åˆ¶è€Œå®šã€‚è¿‡å¤§çš„ CPU æ•°é‡ä¼šå½±å“åˆ° VM çš„æ€§èƒ½ä»¥åŠå†…å­˜å æ¯”</td>
</tr>
<tr>
<td>default_bridges</td>
<td>N</td>
<td>VM é»˜è®¤çš„ PCI æ¡¥æ•°é‡ï¼Œé»˜è®¤ä¸º 1ï¼Œæœ€å¤§ä¸º 5ã€‚ç›®å‰ï¼Œä»…æ”¯æŒ PCI bridgeï¼Œæ¯ä¸ª PCI bridge æœ€å¤šæ”¯æŒ 30 ä¸ªè®¾å¤‡çš„çƒ­æ’æ‹”ï¼Œæ¯ä¸ª VM æœ€å¤šæ”¯æŒ 5 ä¸ª PCI bridgeï¼ˆè¿™å¯èƒ½æ˜¯ QEMU æˆ–å†…æ ¸ä¸­çš„ä¸€ä¸ª bugï¼‰</td>
</tr>
<tr>
<td>default_memory</td>
<td>Y</td>
<td>VM é»˜è®¤çš„å†…å­˜æ€»é‡ï¼Œé»˜è®¤ä¸º 1ï¼Œæœ€å¤§ä¸º host å†…å­˜æ€»é‡</td>
</tr>
<tr>
<td>memory_slots</td>
<td>Y</td>
<td>VM é»˜è®¤çš„å†…å­˜æ’æ§½æ•°é‡ï¼Œé»˜è®¤ä¸º 10ï¼Œå³å†…å­˜çƒ­æ·»åŠ æ¬¡æ•°ä¸Šé™ä¸º 10</td>
</tr>
<tr>
<td>default_maxmemory</td>
<td>Y</td>
<td>VM æœ€å¤§çš„å†…å­˜æ€»é‡ï¼Œé»˜è®¤ä¸º  host å†…å­˜æ€»é‡</td>
</tr>
<tr>
<td>memory_offset</td>
<td>Y</td>
<td>VM å†…å­˜åç§»é‡ï¼Œç”¨äºæè¿° NVDIMM è®¾å¤‡çš„å†…å­˜ç©ºé—´ï¼Œå½“ block_device_driver ä¸º nvdimm æ—¶ï¼Œéœ€è¦è®¾ç½®æ­¤å‚æ•°ï¼Œæœ€ç»ˆä¼šè¿½åŠ åˆ° default_maxmemory ä¸­</td>
</tr>
<tr>
<td>enable_virtio_mem</td>
<td>Y</td>
<td>æ˜¯å¦å¯ç”¨ virtio-mem è®¾å¤‡ï¼Œé»˜è®¤ä¸º falseã€‚virtio-mem è®¾å¤‡å¯ä»¥æé«˜ VM çš„å†…å­˜æ€§èƒ½ã€‚å®ƒé€šè¿‡åœ¨ host å’Œ VM ä¹‹é—´å…±äº«å†…å­˜ï¼Œä½¿ VM å¯ä»¥ç›´æ¥è®¿é—® host å†…å­˜ï¼Œè€Œæ— éœ€é€šè¿‡å¤åˆ¶æˆ–ä¼ è¾“æ•°æ®ã€‚è¿™ç§ç›´æ¥è®¿é—®å¯æ˜¾è‘—é™ä½å†…å­˜è®¿é—®å»¶è¿Ÿå’Œ CPU ä½¿ç”¨ç‡ï¼Œå¹¶æé«˜ VM çš„æ€§èƒ½å’Œååé‡ã€‚æ¨èè®¾ç½® &#x2F;proc&#x2F;sys&#x2F;vm&#x2F;overcommit_memory æ–‡ä»¶å†…å®¹ä¸º 1</td>
</tr>
<tr>
<td>disable_block_device_use</td>
<td>Y</td>
<td>ç¦æ­¢å—è®¾å¤‡ç”¨äºå®¹å™¨çš„ rootfsã€‚ä¾‹å¦‚ devicemapper ä¹‹ç±»çš„å­˜å‚¨é©±åŠ¨ç¨‹åºä¸­ï¼Œå®¹å™¨çš„ rootfs ç”±å—è®¾å¤‡æ”¯æŒï¼Œå‡ºäºæ€§èƒ½åŸå› ï¼Œå—è®¾å¤‡é»˜è®¤ç›´æ¥ä¼ é€’ç»™ hypervisorã€‚ ç¦ç”¨ä¼ é€’æ—¶ï¼Œä¼šç”¨ virtio-fs ä¼ é€’ rootfs</td>
</tr>
<tr>
<td>shared_fs</td>
<td>Y</td>
<td>host å’Œ VM ä¹‹é—´å…±äº«æ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼Œé»˜è®¤ä¸º virtio-fsï¼Œæ­¤å¤–æ”¯æŒ virtio-9p å’Œ virtio-fs-nydus</td>
</tr>
<tr>
<td>virtio_fs_daemon</td>
<td>Y</td>
<td>vhost-user-fs å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„</td>
</tr>
<tr>
<td>valid_virtio_fs_daemon_paths</td>
<td>N</td>
<td>ä»¥ glob(3) è§„åˆ™æ ¡éªŒ virtio_fs_daemon å‚æ•°æ˜¯å¦ä¸ºåˆæ³•çš„è·¯å¾„é›†åˆ</td>
</tr>
<tr>
<td>virtio_fs_cache_size</td>
<td>Y</td>
<td>DAX ç¼“å­˜å¤§å°ï¼Œé»˜è®¤ä¸º 0 MiBã€‚virtio_fs æ”¯æŒ DAXï¼ˆDirect Accessï¼‰æ¨¡å¼ï¼Œè¿™æ„å‘³ç€ VM å¯ä»¥ç›´æ¥è®¿é—® host çš„æ–‡ä»¶ç³»ç»Ÿç¼“å­˜ï¼Œä»è€Œæé«˜äº†è¯»å–å’Œå†™å…¥æ•°æ®çš„é€Ÿåº¦</td>
</tr>
<tr>
<td>virtio_fs_extra_args</td>
<td>Y</td>
<td>vhost-user-fs çš„é¢å¤–é™„åŠ å‚æ•°</td>
</tr>
<tr>
<td>virtio_fs_cache</td>
<td>Y</td>
<td>virtio-fs æ–‡ä»¶ç³»ç»Ÿåœ¨ VM å’Œ host ä¹‹é—´å…±äº«æ–‡ä»¶æ—¶çš„ç¼“å­˜æ¨¡å¼ï¼Œé»˜è®¤æ˜¯ autoï¼Œæ­¤å¤–æ”¯æŒ none å’Œ alwaysã€‚none è¡¨ç¤º VM ä¸­ä¸ç¼“å­˜æ–‡ä»¶ç³»ç»Ÿçš„å…ƒæ•°æ®ã€æ•°æ®å’Œè·¯å¾„åæŸ¥æ‰¾ï¼Œæ‰€æœ‰è¿™äº›ä¿¡æ¯éƒ½éœ€è¦ä» host ä¸­è·å–ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œä»»ä½•å¯¹æ–‡ä»¶çš„ä¿®æ”¹éƒ½ä¼šç«‹å³è¢«æ¨é€åˆ° hostï¼›alway åˆ™æˆªç„¶ç›¸åï¼Œè¡¨ç¤º VM ä¸­çš„æ–‡ä»¶ç³»ç»Ÿå…ƒæ•°æ®ã€æ•°æ®å’Œè·¯å¾„åæŸ¥æ‰¾éƒ½ä¼šè¢«ç¼“å­˜ï¼Œå¹¶ä¸”æ°¸ä¸è¿‡æœŸï¼›è€Œ auto è¡¨ç¤º VM ä¸­çš„å…ƒæ•°æ®å’Œè·¯å¾„åæŸ¥æ‰¾ç¼“å­˜ä¼šåœ¨ä¸€å®šæ—¶é—´åè¿‡æœŸï¼ˆé»˜è®¤ä¸º 1 ç§’ï¼‰ï¼Œè€Œæ•°æ®åˆ™ä¼šåœ¨æ–‡ä»¶æ‰“å¼€æ—¶ç¼“å­˜ï¼ˆå³ close-to-open ä¸€è‡´æ€§ï¼‰ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼ŒVM ä¼šæ ¹æ®éœ€è¦ä» host ä¸­è·å–æ–‡ä»¶ä¿¡æ¯ï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½ä» host è·å–</td>
</tr>
<tr>
<td>block_device_driver</td>
<td>Y</td>
<td>hypervisor ç”¨äºç®¡ç†å®¹å™¨ rootfs çš„å—å­˜å‚¨é©±åŠ¨ç¨‹åºï¼Œé»˜è®¤ä¸º virtio-scsiï¼Œæ­¤å¤–æ”¯æŒ virtio-blk å’Œ nvdimmã€‚virtio-scsi æ˜¯ä¸€ç§åŸºäºSCSI åè®®çš„å­˜å‚¨è™šæ‹ŸåŒ–æŠ€æœ¯ï¼›virtio-blk åˆ™æ˜¯ä¸€ç§ç”¨äºå—è®¾å¤‡çš„å­˜å‚¨è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œåœ¨ä½¿ç”¨ virtio-scsi å’Œ virtio-blk æ—¶ï¼Œhost ä¸Šçš„å—è®¾å¤‡å¯ä»¥è¢« VM è§†ä¸ºæœ¬åœ°çš„å—è®¾å¤‡ï¼Œä»è€Œå¯ä»¥åœ¨ VM ä¸­è¿›è¡Œè¯»å†™æ“ä½œï¼›nvdimm æ˜¯ä¸€ç§ç”¨äºéæ˜“å¤±æ€§å†…å­˜ï¼ˆNVMï¼‰çš„å­˜å‚¨æŠ€æœ¯ã€‚å®ƒå…è®¸å°†å†…å­˜ä½œä¸ºå—è®¾å¤‡ä½¿ç”¨ï¼Œå¹¶æä¾›äº†ä¸ä¼ ç»Ÿå—è®¾å¤‡ç›¸ä¼¼çš„å¯é æ€§å’Œæ•°æ®å®Œæ•´æ€§ä¿æŠ¤</td>
</tr>
<tr>
<td>block_device_aio</td>
<td>Y</td>
<td>QEMU ä½¿ç”¨çš„å—è®¾å¤‡å¼‚æ­¥ I&#x2F;O æœºåˆ¶ï¼Œé»˜è®¤ä¸º io_uringï¼Œæ­¤å¤–æ”¯æŒ threads å’Œ nativeã€‚threads è¡¨ç¤º QEMU ä½¿ç”¨åŸºäº pthread çš„ç£ç›˜ I&#x2F;O æœºåˆ¶ï¼Œè¿™ç§æœºåˆ¶æ˜¯åœ¨ç”¨æˆ·ç©ºé—´å®ç°çš„ï¼Œå¯ä»¥åœ¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´å…±äº« CPU æ—¶é—´ï¼Œä½†æ˜¯æ€§èƒ½æ¯”è¾ƒä¸€èˆ¬ï¼›native è¡¨ç¤º QEMU ä½¿ç”¨æœ¬åœ°çš„ Linux I&#x2F;O æœºåˆ¶ã€‚è¿™ç§æœºåˆ¶æ˜¯åœ¨å†…æ ¸ç©ºé—´å®ç°çš„ï¼Œå¯ä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½ï¼Œä½†æ˜¯éœ€è¦ç‰¹æƒï¼›io_uring è¡¨ç¤º QEMU ä½¿ç”¨ Linux io_uring API æ¥å®ç°å¼‚æ­¥ I&#x2F;Oï¼Œè¿™ç§æœºåˆ¶æä¾›äº† Linux ä¸­æœ€å¿«çš„ I&#x2F;O æ“ä½œï¼Œå¯ä»¥åœ¨ QEMU 5.0 åŠä»¥ä¸Šç‰ˆæœ¬ä¸­ä½¿ç”¨ï¼Œä½†éœ€è¦ Linux å†…æ ¸ç‰ˆæœ¬å¤§äº 5.1ï¼Œio_uring æœºåˆ¶å¯ä»¥å‡å°‘ CPU çš„ä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°ï¼Œæé«˜ I&#x2F;O æ“ä½œçš„æ•ˆç‡</td>
</tr>
<tr>
<td>block_device_cache_set</td>
<td>Y</td>
<td>æ˜¯å¦å°†ç¼“å­˜ç›¸å…³é€‰é¡¹è®¾ç½®ç»™å—è®¾å¤‡ï¼Œé»˜è®¤ä¸º falseã€‚è¯¥å‚æ•°å½±å“åˆ° block_device_cache_direct å’Œ block_device_cache_noflush æ˜¯å¦ç”Ÿæ•ˆ</td>
</tr>
<tr>
<td>block_device_cache_direct</td>
<td>Y</td>
<td>æ˜¯å¦å¯ç”¨ O_DIRECT é€‰é¡¹ï¼Œé»˜è®¤ä¸º falseã€‚O_DIRECT æ˜¯ä¸€ç§ Linux ç³»ç»Ÿæä¾›çš„é€‰é¡¹ï¼Œå¯ä»¥ç»•è¿‡ host é¡µç¼“å­˜ï¼Œç›´æ¥è®¿é—®å—è®¾å¤‡ï¼Œä»è€Œæé«˜å­˜å‚¨ I&#x2F;O çš„æ€§èƒ½ã€‚å— block_device_cache_set å‚æ•°è®¾ç½®å½±å“</td>
</tr>
<tr>
<td>block_device_cache_noflush</td>
<td>Y</td>
<td>æ˜¯å¦å¿½ç•¥å—è®¾å¤‡çš„ç¼“å­˜åˆ·ç›˜è¯·æ±‚ï¼Œé»˜è®¤ä¸º falseã€‚å— block_device_cache_set å‚æ•°è®¾ç½®å½±å“</td>
</tr>
<tr>
<td>enable_iothreads</td>
<td>Y</td>
<td>æ˜¯å¦å¯ç”¨ç‹¬ç«‹çš„ I&#x2F;O çº¿ç¨‹ï¼Œé»˜è®¤ä¸º falseã€‚å¯ç”¨æ—¶ï¼Œå—è®¾å¤‡çš„ I&#x2F;O æ“ä½œå°†åœ¨ä¸€ä¸ªå•ç‹¬çš„ I&#x2F;O çº¿ç¨‹ä¸­å¤„ç†ï¼Œè€Œé QEMU çš„ä¸»çº¿ç¨‹ä¸­è¿›è¡Œå¤„ç†ï¼Œå¯ä»¥å‡å°‘äº†ä¸»çº¿ç¨‹çš„é˜»å¡æ—¶é—´ï¼Œæé«˜ VM çš„ I&#x2F;O æ€§èƒ½</td>
</tr>
<tr>
<td>enable_mem_prealloc</td>
<td>Y</td>
<td>æ˜¯å¦å¯ç”¨ VM å†…å­˜é¢„åˆ†é…ï¼Œé»˜è®¤ä¸º falseã€‚å¯ç”¨ VM å†…å­˜çš„é¢„åˆ†é…å¯ä»¥ä½¿å†…å­˜åˆ†é…æ›´åŠ ç¨³å®šå’Œå¯é¢„æµ‹ï¼Œä»è€Œæé«˜ VM çš„æ€§èƒ½ã€‚ä½†æ˜¯ï¼Œé¢„åˆ†é…å†…å­˜ä¹Ÿä¼šå ç”¨æ›´å¤šçš„ç³»ç»Ÿèµ„æºï¼Œé™ä½å®¹å™¨å¯†åº¦</td>
</tr>
<tr>
<td>enable_hugepages</td>
<td>Y</td>
<td>æ˜¯å¦å¯ç”¨ VM å¤§é¡µå†…å­˜ï¼Œé»˜è®¤ä¸º falseã€‚Huge Pages çš„ç‰¹ç‚¹æ˜¯å°†å†…å­˜åˆ†é…æˆå›ºå®šå¤§å°çš„é¡µï¼ˆé€šå¸¸ä¸º 2MB æˆ– 1GBï¼‰ï¼Œä»è€Œé™ä½äº†é¡µè¡¨çš„å¤§å°å’Œæ“ä½œç³»ç»Ÿå†…æ ¸çš„å¼€é”€ï¼Œä½¿ç”¨ Huge Pages åˆ†é… VM å†…å­˜å¯ä»¥æå‡æ€§èƒ½ã€‚åœ¨å¯ç”¨å¤§é¡µå†…å­˜æ—¶ï¼Œå†…å­˜é¢„åˆ†é…ï¼ˆenable_mem_preallocï¼‰ä¼šè¢«å¼ºåˆ¶è®¾ç½®å¯ç”¨</td>
</tr>
<tr>
<td>enable_vhost_user_store</td>
<td>Y</td>
<td>æ˜¯å¦å¯ç”¨ vhost-user å­˜å‚¨è®¾å¤‡ï¼Œé»˜è®¤ä¸º falseã€‚å¯ç”¨ vhost-user å­˜å‚¨è®¾å¤‡å¯ä»¥å°† host ä¸Šçš„å—è®¾å¤‡è™šæ‹ŸåŒ–ä¸ºä¸€ç§å¯ä»¥åœ¨ VM ä¸­ä½¿ç”¨çš„è®¾å¤‡ï¼Œé€šè¿‡ vhost-user åè®®åœ¨ host å’Œ VM ä¹‹é—´ä¼ è¾“æ•°æ®ï¼Œä»è€Œæé«˜ VM çš„å­˜å‚¨æ€§èƒ½ã€‚åœ¨å¯ç”¨ vhost-user å­˜å‚¨è®¾å¤‡æ—¶ï¼ŒLinux ä¸­çš„ä¸€äº›ä¿ç•™å—ç±»å‹ï¼ˆMajor Range 240-254ï¼‰å°†è¢«é€‰æ‹©ç”¨äºè¡¨ç¤º vhost-user è®¾å¤‡</td>
</tr>
<tr>
<td>vhost_user_store_path</td>
<td>Y</td>
<td>vhost-user è®¾å¤‡çš„ç›®å½•ï¼Œé»˜è®¤ä¸º &#x2F;var&#x2F;run&#x2F;kata-containers&#x2F;vhost-userã€‚åœ¨è¯¥ç›®å½•ä¸‹ï¼Œâ€blockâ€ å­ç›®å½•ç”¨äºå­˜å‚¨å—è®¾å¤‡ï¼Œâ€block&#x2F;socketsâ€ å­ç›®å½•ç”¨äºå­˜å‚¨ vhost-user socketsï¼Œâ€block&#x2F;devicesâ€ å­ç›®å½•ç”¨äºå­˜å‚¨æ¨¡æ‹Ÿçš„å—è®¾å¤‡èŠ‚ç‚¹</td>
</tr>
<tr>
<td>enable_iommu</td>
<td>Y</td>
<td>æ˜¯å¦å¯ç”¨ vIOMMU è®¾å¤‡ï¼Œé»˜è®¤ä¸º falseã€‚vIOMMU ç”¨äºå°† VM çš„ I&#x2F;O æ“ä½œéš”ç¦»åœ¨ä¸€ä¸ªç‹¬ç«‹çš„å†…å­˜åœ°å€ç©ºé—´ä¸­ï¼Œä»¥æé«˜ VM çš„å®‰å…¨æ€§å’Œæ€§èƒ½ã€‚æ­¤å¤–ï¼ŒvIOMMU è¿˜å¯ä»¥æä¾›æ›´å¥½çš„ I&#x2F;O æ€§èƒ½ï¼Œå› ä¸ºå®ƒå¯ä»¥å‡å°‘ VM å’Œ host ä¹‹é—´çš„æ•°æ®ä¼ è¾“æ¬¡æ•°</td>
</tr>
<tr>
<td>enable_iommu_platform</td>
<td>Y</td>
<td>æ˜¯å¦å¯ç”¨ IOMMU_PLATFORM è®¾å¤‡ï¼Œé»˜è®¤ä¸º falseã€‚IOMMU_PLATFORM ç”¨äºè®¾å¤‡ DMAï¼ˆDirect Memory Accessï¼‰æ“ä½œéš”ç¦»åœ¨ä¸€ä¸ªç‹¬ç«‹çš„å†…å­˜åœ°å€ç©ºé—´ä¸­ï¼Œä»¥æé«˜ç³»ç»Ÿçš„å®‰å…¨æ€§å’Œæ€§èƒ½ã€‚æ­¤å¤–ï¼ŒIOMMU_PLATFORM è¿˜å¯ä»¥æä¾›æ›´å¥½çš„ DMA æ€§èƒ½ï¼Œå› ä¸ºå®ƒå¯ä»¥å‡å°‘ç³»ç»Ÿå’Œè®¾å¤‡ä¹‹é—´çš„æ•°æ®ä¼ è¾“æ¬¡æ•°ã€‚</td>
</tr>
<tr>
<td>valid_vhost_user_store_paths</td>
<td>N</td>
<td>ä»¥ glob(3) è§„åˆ™æ ¡éªŒ vhost_user_store_path å‚æ•°æ˜¯å¦ä¸ºåˆæ³•çš„è·¯å¾„é›†åˆ</td>
</tr>
<tr>
<td>file_mem_backend</td>
<td>Y</td>
<td>åŸºäºæ–‡ä»¶çš„å†…å­˜æ”¯æŒçš„è·¯å¾„ï¼Œé»˜è®¤ä¸ºç©ºã€‚åŸºäºæ–‡ä»¶çš„ VM å†…å­˜æ”¯æŒæ˜¯ä¸€ç§å°† VM å†…å­˜ä¿å­˜åœ¨æ–‡ä»¶ä¸­çš„æŠ€æœ¯ï¼Œè€Œä¸æ˜¯ä¿å­˜åœ¨ host çš„ç‰©ç†å†…å­˜ä¸­ã€‚æ­¤å¤–ï¼Œä½¿ç”¨åŸºäºæ–‡ä»¶çš„ VM å†…å­˜è¿˜å¯ä»¥å‡å°‘ VM å’Œ host ä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼Œä»è€Œæé«˜ VM çš„æ€§èƒ½ã€‚åœ¨ä½¿ç”¨ virtio-fs æ—¶ï¼Œè¯¥é€‰é¡¹ä¼šè‡ªåŠ¨å¯ç”¨ï¼Œå¹¶ä½¿ç”¨ â€œ&#x2F;dev&#x2F;shmâ€ ä½œä¸ºåç«¯æ–‡ä»¶</td>
</tr>
<tr>
<td>valid_file_mem_backends</td>
<td>N</td>
<td>ä»¥ glob(3) è§„åˆ™æ ¡éªŒ file_mem_backend å‚æ•°æ˜¯å¦ä¸ºåˆæ³•çš„è·¯å¾„é›†åˆ</td>
</tr>
<tr>
<td>pflashes</td>
<td>N</td>
<td>å‘ VM ä¸­æ·»åŠ çš„é•œåƒæ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤ä¸ºç©ºã€‚é•œåƒæ–‡ä»¶é€šå¸¸ç”¨äºæ¨¡æ‹Ÿç³»ç»Ÿä¸­çš„ BIOS æˆ– UEFI  å›ºä»¶ç­‰ã€‚ä¾‹å¦‚ï¼Œarm64 æ¶æ„ä¸‹çš„å†…å­˜çƒ­æ’æ‹”åˆ™éœ€è¦æä¾›ä¸€å¯¹ pflash</td>
</tr>
<tr>
<td>enable_debug</td>
<td>N</td>
<td>æ˜¯å¦å¯ç”¨ hypervisor å’Œå†…æ ¸çš„ debug å‚æ•°ï¼Œé»˜è®¤ä¸º false</td>
</tr>
<tr>
<td>disable_nesting_checks</td>
<td>N</td>
<td>æ˜¯å¦ç¦æ­¢åµŒå¥—è™šæ‹ŸåŒ–ç¯å¢ƒæ£€æŸ¥ï¼Œé»˜è®¤ä¸º falseã€‚ç¦ç”¨åµŒå¥—æ£€æŸ¥å¯ä»¥ä»è¿è¡Œæ—¶çš„è¡Œä¸ºä¸åœ¨è£¸æœºä¸Šç›¸åŒ</td>
</tr>
<tr>
<td>msize_9p</td>
<td>Y</td>
<td>virtio-9p å…±äº«æ–‡ä»¶ç³»ç»Ÿä¸­æè¿° 9p æ•°æ®åŒ…æœ‰æ•ˆè½½è·çš„å­—èŠ‚æ•°é‡ï¼Œé»˜è®¤ä¸º 8192</td>
</tr>
<tr>
<td>disable_image_nvdimm</td>
<td>Y</td>
<td>æ˜¯å¦ç¦æ­¢ä½¿ç”¨ NVDIMM è®¾å¤‡æŒ‚è½½ VM é•œåƒï¼Œé»˜è®¤ä¸º falseã€‚åœ¨æœªç¦ç”¨ä¸”æ”¯æŒ NVDIMM è®¾å¤‡æ—¶ï¼ŒVM é•œåƒä¼šå€ŸåŠ© NVDIMM è®¾å¤‡çƒ­æ·»åŠ ï¼Œå¦åˆ™ï¼Œä½¿ç”¨ virtio-block è®¾å¤‡</td>
</tr>
<tr>
<td>hotplug_vfio_on_root_bus</td>
<td>Y</td>
<td>æ˜¯å¦å…è®¸ VFIO è®¾å¤‡åœ¨ root æ€»çº¿ä¸Šçƒ­æ’æ‹”ï¼Œé»˜è®¤ä¸º trueã€‚VFIO æ˜¯ä¸€ç§ç”¨äºè™šæ‹ŸåŒ–ç¯å¢ƒä¸­çš„è®¾å¤‡ç›´é€šæŠ€æœ¯ï¼Œå®ƒå…è®¸å°†ç‰©ç†è®¾å¤‡ç›´æ¥åˆ†é…ç»™ VMï¼Œä»è€Œæé«˜ VM çš„æ€§èƒ½å’Œå¯é æ€§ã€‚ç„¶è€Œï¼Œåœ¨æ¡¥æ¥è®¾å¤‡ä¸Šè¿›è¡Œ VFIO è®¾å¤‡çš„çƒ­æ’æ‹”å­˜åœ¨ä¸€äº›é™åˆ¶ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå…·æœ‰å¤§å‹ PCI æ¡çš„è®¾å¤‡ã€‚å› æ­¤ï¼Œé€šè¿‡å°†è¯¥é€‰é¡¹è®¾ç½®ä¸º trueï¼Œå¯ä»¥åœ¨ root æ€»çº¿ä¸Šå¯ç”¨ VFIO è®¾å¤‡çš„çƒ­æ’æ‹”ï¼Œä»è€Œè§£å†³è¿™äº›é™åˆ¶é—®é¢˜</td>
</tr>
<tr>
<td>pcie_root_port</td>
<td>Y</td>
<td>pcie_root_port è®¾å¤‡æ•°é‡ï¼Œé»˜è®¤ä¸º 0ã€‚åœ¨çƒ­æ’æ‹” PCIe è®¾å¤‡ä¹‹å‰éœ€è¦æ·»åŠ  pcie_root_port è®¾å¤‡ï¼Œä¸»è¦é’ˆå¯¹ä½¿ç”¨ä¸€äº›å¤§å‹ PCI æ¡è®¾å¤‡ï¼ˆå¦‚ Nvidia GPUï¼‰çš„æƒ…å†µã€‚ä»…åœ¨å¯ç”¨ hotplug_vfio_on_root_bus ä¸” machine_type ä¸º q35 æ—¶ç”Ÿæ•ˆ</td>
</tr>
<tr>
<td>disable_vhost_net</td>
<td>Y</td>
<td>æ˜¯å¦ç¦ç”¨ vhost-net ä½œä¸º virtio-net çš„åç«¯ï¼Œé»˜è®¤ä¸º falseã€‚ä½¿ç”¨ vhost-net æ—¶æ„å‘³ç€åœ¨æé«˜ç½‘ç»œ I&#x2F;O æ€§èƒ½çš„åŒæ—¶ï¼Œä¼šç‰ºç‰²ä¸€å®šçš„å®‰å…¨æ€§ï¼ˆå› ä¸º vhost-net è¿è¡Œåœ¨ ring0 æ¨¡å¼ä¸‹ï¼Œå…·æœ‰æœ€é«˜çš„æƒé™å’Œç‰¹æƒï¼‰</td>
</tr>
<tr>
<td>entropy_source</td>
<td>Y</td>
<td>ç†µæºè·¯å¾„ï¼Œé»˜è®¤ä¸º &#x2F;dev&#x2F;urandomï¼Œç”¨äºç”Ÿæˆéšæœºæ•°çš„æ¥æºã€‚&#x2F;dev&#x2F;random æ˜¯ä¸€ä¸ªé˜»å¡çš„ç†µæºï¼Œå¦‚æœ host çš„ç†µæ± ç”¨å°½ï¼ŒVM çš„å¯åŠ¨æ—¶é—´ä¼šå¢åŠ ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¯åŠ¨è¶…æ—¶ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œ&#x2F;dev&#x2F;urandom æ˜¯ä¸€ä¸ªéé˜»å¡çš„ç†µæºï¼Œå¯ä»¥é€‚ç”¨äºå¤§å¤šæ•°åœºæ™¯</td>
</tr>
<tr>
<td>valid_entropy_sources</td>
<td>N</td>
<td>ä»¥ glob(3) è§„åˆ™æ ¡éªŒ entropy_source å‚æ•°æ˜¯å¦ä¸ºåˆæ³•çš„è·¯å¾„é›†åˆ</td>
</tr>
<tr>
<td>guest_hook_path</td>
<td>Y</td>
<td>VM ä¸­ hook è„šæœ¬è·¯å¾„ï¼Œé»˜è®¤ä¸ºç©ºã€‚hook å¿…é¡»æŒ‰ç…§å…¶ hook ç±»å‹å­˜å‚¨åœ¨ guest_hook_path çš„å­ç›®å½•ä¸­ï¼Œä¾‹å¦‚ â€œguest_hook_path&#x2F;{prestart,poststart,poststop}â€ã€‚Kata agent å°†æ‰«æè¿™äº›ç›®å½•æŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶ï¼ŒæŒ‰å­—æ¯é¡ºåºå°†å…¶æ·»åŠ åˆ°å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œå¹¶åœ¨ VM è¿è¡Œæ—¶å‘½åç©ºé—´ä¸­æ‰§è¡Œ</td>
</tr>
<tr>
<td>rx_rate_limiter_max_rate</td>
<td>Y</td>
<td>ç½‘ç»œ I&#x2F;O inbound å¸¦å®½é™åˆ¶ï¼Œé»˜è®¤ä¸º 0ï¼Œå³ä¸ä½œé™åˆ¶ã€‚åœ¨ QEMU ä¸­ï¼Œå€ŸåŠ© HTB(Hierarchy Token Bucket) é™åˆ¶ç®¡ç†</td>
</tr>
<tr>
<td>tx_rate_limiter_max_rate</td>
<td>Y</td>
<td>ç½‘ç»œ I&#x2F;O outbound å¸¦å®½é™åˆ¶ï¼Œé»˜è®¤ä¸º 0ï¼Œå³ä¸ä½œé™åˆ¶ã€‚åœ¨ QEMU ä¸­ï¼Œå€ŸåŠ© HTB(Hierarchy Token Bucket) é™åˆ¶ç®¡ç†</td>
</tr>
<tr>
<td>guest_memory_dump_path</td>
<td>N</td>
<td>VM å†…å­˜è½¬å‚¨æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤ä¸ºç©ºã€‚åœ¨å‡ºç° GUEST_PANICKED äº‹ä»¶æ—¶ï¼ŒVM çš„å†…å­˜å°†è¢«è½¬å‚¨åˆ° host æ–‡ä»¶ç³»ç»Ÿä¸‹çš„æŒ‡å®šç›®å½•ä¸­ï¼ˆå¦‚æœè¯¥ç›®å½•ä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºï¼‰ã€‚è¢«è½¬å‚¨çš„æ–‡ä»¶ï¼ˆä¹Ÿç§°ä¸º vmcore æ–‡ä»¶ï¼‰å¯ä»¥ä½¿ç”¨ crash æˆ– gdb ç­‰å·¥å…·è¿›è¡Œå¤„ç†ã€‚æ³¨æ„ï¼Œè½¬å‚¨ VM å†…å­˜å¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œå…·ä½“å–å†³äº VM å†…å­˜çš„å¤§å°ï¼Œå¹¶ä¸”ä¼šå ç”¨å¤§é‡ç£ç›˜ç©ºé—´</td>
</tr>
<tr>
<td>guest_memory_dump_paging</td>
<td>N</td>
<td>æ˜¯å¦å¯ç”¨ VM å†…å­˜åˆ†é¡µï¼Œé»˜è®¤ä¸º falseã€‚åœ¨ VM å†…å­˜è½¬å‚¨æ—¶ï¼Œå°†ä½¿ç”¨åˆ†é¡µæœºåˆ¶æ¥å¤„ç†è™šæ‹Ÿåœ°å€å’Œç‰©ç†åœ°å€ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚å¦‚æœç¦ç”¨è¯¥é€‰é¡¹ï¼Œåˆ™å°†ä½¿ç”¨ç‰©ç†åœ°å€è€Œä¸æ˜¯è™šæ‹Ÿåœ°å€æ¥è¿›è¡Œè½¬å‚¨ã€‚æ¯”å¦‚ï¼Œå¦‚æœå¸Œæœ›ä½¿ç”¨ gdb å·¥å…·è€Œä¸æ˜¯ crash å·¥å…·ï¼Œæˆ–è€…éœ€è¦åœ¨ ELF vmcore ä¸­ä½¿ç”¨VM çš„è™šæ‹Ÿåœ°å€ï¼Œé‚£ä¹ˆåˆ™éœ€è¦å¯ç”¨å†…å­˜åˆ†é¡µåŠŸèƒ½</td>
</tr>
<tr>
<td>enable_guest_swap</td>
<td>Y</td>
<td>æ˜¯å¦å¯ç”¨ VM ä¸­çš„äº¤æ¢ç©ºé—´ï¼Œé»˜è®¤ä¸º falseã€‚å¯ç”¨æ—¶ï¼Œä¼šå°†ä¸€ä¸ª raw æ ¼å¼çš„è®¾å¤‡æ·»åŠ åˆ° VM ä¸­ä½œä¸º SWAP è®¾å¤‡ã€‚å¦‚æœ annotations[â€œio.katacontainers.container.resource.swappinessâ€] å¤§äº 0ï¼Œåˆ™æ ¹æ® annotations[â€œio.katacontainers.container.resource.swap_in_bytesâ€] è®¡ç®— SWAP è®¾å¤‡å¤§å°ï¼šé»˜è®¤ä¸º swap_in_bytes - memory_limit_in_bytesï¼›å¦‚æœ swap_in_bytes æœªè®¾ç½®ï¼Œåˆ™ä¸º memory_limit_in_bytesï¼Œå¦‚æœå‡æœªè®¾ç½®ï¼Œåˆ™ä¸º default_memory</td>
</tr>
<tr>
<td>use_legacy_serial</td>
<td>Y</td>
<td>æ˜¯å¦ä½¿ç”¨ä¼ ç»Ÿçš„ä¸²è¡Œæ¥å£ä½œä¸º VM æ§åˆ¶å°è®¾å¤‡ï¼Œé»˜è®¤ä¸º false</td>
</tr>
<tr>
<td>disable_selinux</td>
<td>N</td>
<td>æ˜¯å¦ç¦ç”¨åœ¨ hypervisor ä¸Šåº”ç”¨ SELinuxï¼Œé»˜è®¤ä¸º false</td>
</tr>
</tbody></table>
<h2 id="factory"><a href="#factory" class="headerlink" title="factory"></a>factory</h2><p>ä¸æ”¯æŒåŠ¨æ€é…ç½®é¡¹</p>
<table>
<thead>
<tr>
<th>é™æ€é…ç½®é¡¹</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>enable_template</td>
<td>æ˜¯å¦å¯ç”¨ VM æ¨¡æ¿ï¼Œé»˜è®¤ä¸º falseã€‚ å¯ç”¨åï¼Œä»æ¨¡æ¿å…‹éš†åˆ›å»ºæ–°çš„ VMã€‚ å®ƒä»¬å°†é€šè¿‡åªè¯»æ˜ å°„å…±äº«ç›¸åŒçš„å†…æ ¸ã€initramfs å’Œ Kata agent å†…å­˜ã€‚ å¦‚æœåœ¨åŒä¸€ host ä¸Šè¿è¡Œè®¸å¤š Kata å®¹å™¨ï¼ŒVM æ¨¡æ¿æœ‰åŠ©äºåŠ å¿«å®¹å™¨çš„åˆ›å»ºå¹¶èŠ‚çœå¤§é‡å†…å­˜ã€‚ä»…æ”¯æŒé•œåƒç±»å‹ä¸º initrd</td>
</tr>
<tr>
<td>template_path</td>
<td>VM æ¨¡æ¿ä¿å­˜çš„è·¯å¾„ï¼Œé»˜è®¤ä¸º &#x2F;run&#x2F;vc&#x2F;vm&#x2F;template</td>
</tr>
<tr>
<td>vm_cache_number</td>
<td>VMCache çš„æ•°é‡ï¼Œé»˜è®¤ä¸º 0ï¼Œè¡¨ç¤ºç¦ç”¨ VMCacheã€‚VMCache æ˜¯ä¸€ç§åœ¨ä½¿ç”¨ä¹‹å‰å°† VM åˆ›å»ºä¸ºç¼“å­˜çš„åŠŸèƒ½ï¼Œæœ‰åŠ©äºåŠ å¿«å®¹å™¨çš„åˆ›å»ºã€‚ è¯¥åŠŸèƒ½ç”±æœåŠ¡å™¨å’Œé€šè¿‡ Unix socket è¿›è¡Œé€šä¿¡çš„å®¢æˆ·ç«¯ç»„æˆï¼ŒæœåŠ¡å™¨å°†åˆ›å»ºä¸€äº› VM å¹¶ç¼“å­˜èµ·æ¥ã€‚å¦‚æœå¯ç”¨äº† VMCache åŠŸèƒ½ï¼Œkata-runtime åœ¨åˆ›å»ºæ–°çš„ sandbox æ—¶ä¼šå‘ VMCache æœåŠ¡å™¨è¯·æ±‚ VM</td>
</tr>
<tr>
<td>vm_cache_endpoint</td>
<td>VMCache æœåŠ¡å™¨çš„ socket åœ°å€ï¼Œé»˜è®¤ä¸º &#x2F;var&#x2F;run&#x2F;kata-containers&#x2F;cache.sock</td>
</tr>
</tbody></table>
<h2 id="runtime"><a href="#runtime" class="headerlink" title="runtime"></a>runtime</h2><p>åŠ¨æ€é…ç½®é¡¹çš„å‰ç¼€ä¸º io.katacontainers.config.runtime.&lt;é™æ€é…ç½®é¡¹&gt;</p>
<table>
<thead>
<tr>
<th>é™æ€é…ç½®é¡¹</th>
<th>åŠ¨æ€é…ç½®</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>enable_debug</td>
<td>N</td>
<td>æ˜¯å¦å¯ç”¨ containerd-shim-kata-v2 çš„ debug å‚æ•°ï¼Œé»˜è®¤ä¸º false</td>
</tr>
<tr>
<td>internetworking_model</td>
<td>Y</td>
<td>VM ä¸å®¹å™¨ç½‘ç»œçš„è¿é€šæ–¹å¼ï¼Œé»˜è®¤ä¸º tcfilterï¼Œæ­¤å¤–æ”¯æŒ tcfilterã€macvtap å’Œ noneã€‚æ— è®ºå“ªç§æ–¹å¼ï¼Œtap è®¾å¤‡éƒ½æ˜¯åˆ›å»ºçš„ï¼ŒåŒºåˆ«åœ¨äº tap è®¾å¤‡å’Œå®¹å™¨ç½‘ç»œæ˜¯å¦‚ä½•æ‰“é€šçš„</td>
</tr>
<tr>
<td>disable_guest_seccomp</td>
<td>Y</td>
<td>æ˜¯å¦åœ¨ VM ä¸­å¯ç”¨ seccomp ç‰¹æ€§ï¼Œé»˜è®¤ä¸º falseã€‚å¯ç”¨æ—¶ï¼Œseccomp é…ç½®æ–‡ä»¶ä¼šç”± Kata agent ä¼ é€’åˆ° VM ä¸­å¹¶åº”ç”¨ï¼Œç”¨äºæä¾›é¢å¤–çš„å®‰å…¨å±‚</td>
</tr>
<tr>
<td>enable_tracing</td>
<td>N</td>
<td>æ˜¯å¦å¯ç”¨ opentracing çš„ traces å’Œ spansï¼Œé»˜è®¤ä¸º false</td>
</tr>
<tr>
<td>jaeger_endpoint</td>
<td>N</td>
<td>Jaeger æœåŠ¡åœ°å€ï¼Œé»˜è®¤ä¸º <code>http://localhost:14268/api/traces</code></td>
</tr>
<tr>
<td>jaeger_user</td>
<td>N</td>
<td>Jaeger æœåŠ¡è´¦å·ï¼Œé»˜è®¤ä¸ºç©º</td>
</tr>
<tr>
<td>jaeger_password</td>
<td>N</td>
<td>Jaeger æœåŠ¡å¯†ç ï¼Œé»˜è®¤ä¸ºç©º</td>
</tr>
<tr>
<td>disable_new_netns</td>
<td>Y</td>
<td>æ˜¯å¦ç¦æ­¢ä¸º shim å’Œ hypervisor è¿›ç¨‹åˆ›å»ºç½‘ç»œå‘½åç©ºé—´ï¼Œé»˜è®¤ä¸º falseã€‚é€‚ç”¨äº internetworking_model ä¸º noneï¼Œæ­¤æ—¶ tap è®¾å¤‡å°†ä½äº host ç½‘ç»œå‘½åç©ºé—´ä¸­ï¼Œå¹¶å¯ä»¥ç›´æ¥è¿æ¥åˆ° bridgeï¼ˆå¦‚ OVSï¼‰</td>
</tr>
<tr>
<td>sandbox_cgroup_only</td>
<td>Y</td>
<td>æ˜¯å¦ä»…å¯ç”¨ sandboxCgroupï¼Œé»˜è®¤ä¸º falseã€‚å¯ç”¨æ—¶ï¼Œcgroups ä»…æœ‰ä¸€ä¸ª sandboxCgroupï¼Œç”¨äºé™åˆ¶æ‰€æœ‰çš„ Kata è¿›ç¨‹ï¼›ç¦ç”¨æ—¶ï¼Œcgroups åˆ†ä¸º sandboxCgroup å’Œ overheadCgroupï¼Œé™¤ vCPU çº¿ç¨‹å¤–çš„å…¶ä»– Kata è¿›ç¨‹å’Œçº¿ç¨‹éƒ½å°†åœ¨ overheadCgroup ä¸‹è¿è¡Œ</td>
</tr>
<tr>
<td>static_sandbox_resource_mgmt</td>
<td>N</td>
<td>æ˜¯å¦å¯ç”¨é™æ€èµ„æºç®¡ç†ï¼Œé»˜è®¤ä¸º falseã€‚å¯ç”¨æ—¶ï¼ŒKata Containers å°†åœ¨ VM å¯åŠ¨ä¹‹å‰å°è¯•ç¡®å®šé€‚å½“çš„èµ„æºå¤§å°ï¼Œè€ŒéåŠ¨æ€æ›´æ–° VM ä¸­çš„å†…å­˜å’Œ CPU æ•°é‡ï¼Œç”¨ä½œä¸æ”¯æŒ CPU å’Œå†…å­˜çƒ­æ’æ‹”çš„ç¡¬ä»¶æ¶æ„æˆ– hypervisor è§£å†³æ–¹æ¡ˆ</td>
</tr>
<tr>
<td>sandbox_bind_mounts</td>
<td>N</td>
<td>VM ä¸­å¾…æŒ‚è½½ host çš„æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤ä¸ºç©ºã€‚å¯ç”¨æ—¶ï¼Œhost çš„è¯¥è·¯å¾„æ–‡ä»¶ä¼šè¢«ä»¥åªè¯»çš„å½¢å¼æŒ‚è½½åˆ° VM çš„ &#x2F;run&#x2F;kata-containers&#x2F;shared&#x2F;containers&#x2F;sandbox-mounts è·¯å¾„ä¸­ï¼Œä¸ä¼šæš´éœ²ç»™å®¹å™¨å·¥ä½œè´Ÿè½½ï¼Œä»…ä¸ºæ½œåœ¨çš„ VM æœåŠ¡æä¾›</td>
</tr>
<tr>
<td>vfio_mode</td>
<td>Y</td>
<td>VFIO çš„æ¨¡å¼ï¼Œé»˜è®¤ä¸º guest-kernelï¼Œå¯é€‰çš„æœ‰ vfio å’Œ guest-kernelã€‚vfio ä¸ runC çš„è¡Œä¸ºç›¸è¿‘ï¼Œåœ¨å®¹å™¨ä¸­ï¼ŒVFIO è®¾å¤‡å°†æ˜¾ç¤ºä¸º VFIO å­—ç¬¦è®¾å¤‡ï¼Œä½äº &#x2F;dev&#x2F;vfio ä¸‹ï¼Œç¡®åˆ‡çš„åç§°å¯èƒ½ä¸ host ä¸åŒï¼ˆéœ€è¦åŒ¹é… VM çš„ IOMMU ç»„å·ï¼Œè€Œä¸æ˜¯ host çš„ï¼‰ï¼›guest-kernel æ˜¯ Kata ç‰¹æœ‰çš„è¡Œä¸ºï¼ŒVFIO è®¾å¤‡ç”± VM å†…æ ¸ä¸­çš„é©±åŠ¨ç¨‹åºç®¡ç†ï¼Œæ„å‘³ç€å®ƒå°†æ˜¾ç¤ºä¸ºä¸€ä¸ªæˆ–å¤šä¸ªè®¾å¤‡èŠ‚ç‚¹æˆ–ç½‘ç»œæ¥å£ï¼Œå…·ä½“å–å†³äºè®¾å¤‡çš„ç‰¹æ€§ã€‚è¿™ç§æ¨¡å¼è¦æ±‚å®¹å™¨å†…çš„å·¥ä½œè´Ÿè½½å…·æœ‰æ˜¾å¼æ”¯æŒ VM å†…è®¾å¤‡çš„ä»£ç æˆ–é€»è¾‘</td>
</tr>
<tr>
<td>disable_guest_empty_dir</td>
<td>N</td>
<td>æ˜¯å¦ç¦ç”¨åœ¨ VM æ–‡ä»¶ç³»ç»Ÿåˆ›å»º emptyDir æŒ‚è½½ç‚¹ï¼Œé»˜è®¤ä¸º falseã€‚ç¦ç”¨æ—¶ï¼ŒKata Containers å°†ä¸ä¼šåœ¨ VM æ–‡ä»¶ç³»ç»Ÿä¸Šåˆ›å»º Kubernetes emptyDir æŒ‚è½½ç‚¹ï¼Œè€Œæ˜¯åœ¨ host ä¸Šåˆ›å»º emptyDir æŒ‚è½½ç‚¹ï¼Œå¹¶é€šè¿‡ virtio-fs å…±äº«ï¼Œè™½ç„¶æ›´æ…¢ä¸€äº›ï¼Œä½†å…è®¸ä» host å…±äº«æ–‡ä»¶åˆ° VM ä¸­</td>
</tr>
<tr>
<td>experimental</td>
<td>Y</td>
<td>ä½“éªŒç‰¹æ€§ï¼Œé»˜è®¤ä¸ºç©ºã€‚<em>æš‚æœªæœ‰æ”¯æŒçš„ä½“éªŒç‰¹æ€§</em></td>
</tr>
<tr>
<td>enable_pprof</td>
<td>Y</td>
<td>æ˜¯å¦å¯ç”¨ pprofï¼Œé»˜è®¤ä¸º falseã€‚å¯ç”¨åï¼Œå¯ä»¥é€šè¿‡ kata-monitor è¿è¡Œ pprof å·¥å…·æ¥åˆ†æ shim è¿›ç¨‹</td>
</tr>
</tbody></table>
<h2 id="annotation-å‚æ•°æ‰©å±•"><a href="#annotation-å‚æ•°æ‰©å±•" class="headerlink" title="annotation å‚æ•°æ‰©å±•"></a>annotation å‚æ•°æ‰©å±•</h2><p>Kata Containers å¯ä»¥é€šè¿‡ annotation çš„æ–¹å¼å®šåˆ¶åŒ–æ¯ä¸€ä¸ª Kata å®¹å™¨çš„åº•å±‚è¿è¡Œæ—¶å‚æ•°ï¼š</p>
<ul>
<li>ä¸Šå±‚å®¹å™¨è¿è¡Œæ—¶å°† annotation é€ä¼ è‡³åº•å±‚è¿è¡Œæ—¶ï¼ˆä¾‹å¦‚ Containerd 1.4.x ä»¥ä¸Šçš„ç‰ˆæœ¬æ”¯æŒ annotation é€ä¼ ï¼›CRI-O é»˜è®¤é€ä¼ æ‰€æœ‰ annotationï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚<em>å…·ä½“å‚è€ƒ Container Manager é›†æˆ</em>ï¼‰</li>
<li>Kata Containers é…ç½®ä¸­å¼€å¯è¯†åˆ«ç‰¹å®šçš„ annotationï¼ˆ[hypervisor].enable_annotationsï¼‰</li>
</ul>
<p>æ­¤å¤–ï¼ŒKata Containers æ”¯æŒ OCI å’Œå®¹å™¨çº§åˆ«çš„é…ç½®ï¼Œä¾‹å¦‚ï¼š</p>
<p><strong>OCI é…ç½®</strong></p>
<table>
<thead>
<tr>
<th>é…ç½®é¡¹</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>io.katacontainers.config_path</td>
<td>Kata Containers é…ç½®æ–‡ä»¶è·¯å¾„</td>
</tr>
<tr>
<td>io.katacontainers.pkg.oci.bundle_path</td>
<td>OCI bundle è·¯å¾„</td>
</tr>
<tr>
<td>io.katacontainers.pkg.oci.container_type</td>
<td>OCI å®¹å™¨ç±»å‹ï¼Œå¯é€‰çš„æœ‰ pod_container å’Œ pod_sandbox</td>
</tr>
</tbody></table>
<p><strong>å®¹å™¨é…ç½®</strong></p>
<table>
<thead>
<tr>
<th>é…ç½®é¡¹</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>io.katacontainers.container.resource.swappiness</td>
<td>å³ Resources.Memory.Swappinessï¼Œç”¨äºé…ç½®å®¹å™¨å†…å­˜ç®¡ç†å™¨åœ¨ä½•æ—¶å°†å†…å­˜é¡µé¢å†™å…¥ SWAP ç©ºé—´çš„ä¸€ä¸ªç›¸å¯¹åº¦é‡ã€‚è¯¥å‚æ•°çš„å€¼ä»‹äº 0 å’Œ 100 ä¹‹é—´ï¼Œè¡¨ç¤ºå†…å­˜é¡µé¢çš„ä½¿ç”¨é¢‘ç‡</td>
</tr>
<tr>
<td>io.katacontainers.container.resource.swap_in_bytes</td>
<td>å³ Resources.Memory.Swapï¼Œç”¨äºé…ç½®å®¹å™¨å¯ä»¥ä½¿ç”¨çš„ SWAP ç©ºé—´çš„å¤§å°</td>
</tr>
</tbody></table>
<p>ä¾‹å¦‚ï¼Œé€šè¿‡ annotation å¯åŠ¨ä¸€ä¸ªå¿½ç•¥åº•å±‚é»˜è®¤å¤§å°ï¼Œå…·æœ‰ 5 CPUs çš„ VMï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">kata</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">io.katacontainers.config.hypervisor.default_vcpus:</span> <span class="string">&quot;5&quot;</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">runtimeClassName:</span> <span class="string">kata</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">kata</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">busybox</span></span><br><span class="line">    <span class="attr">command:</span> [<span class="string">&quot;/bin/sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;tail -f /dev/null&quot;</span>]</span><br></pre></td></tr></table></figure>

<h1 id="ä¸-Container-Manager-é›†æˆ"><a href="#ä¸-Container-Manager-é›†æˆ" class="headerlink" title="ä¸ Container Manager é›†æˆ"></a>ä¸ Container Manager é›†æˆ</h1><h2 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h2><p><em>TODOï¼šDocker 23.0.0 ç‰ˆæœ¬ï¼Œæ–°å¢äº†è¿è¡Œæ—¶ shim çš„æ”¯æŒï¼Œä¹Ÿå°±æ”¯æŒäº† Kata Containers</em></p>
<h2 id="Containerd"><a href="#Containerd" class="headerlink" title="Containerd"></a>Containerd</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç”Ÿæˆ Containerd é»˜è®¤çš„é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo <span class="built_in">mkdir</span> -p /etc/containerd</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">containerd config default | sudo <span class="built_in">tee</span> /etc/containerd/config.toml</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼ŒContainerd çš„é»˜è®¤åº•å±‚è¿è¡Œæ—¶ä¸º runCï¼Œæ–°å¢ä»¥ä¸‹å†…å®¹æ”¯æŒ Kata Containersï¼š</p>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes]</span></span><br><span class="line">   <span class="section">[plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes.kata]</span></span><br><span class="line">       <span class="attr">runtime_type</span> = <span class="string">&quot;io.containerd.kata.v2&quot;</span></span><br><span class="line">       <span class="attr">privileged_without_host_devices</span> = <span class="literal">true</span></span><br><span class="line">       <span class="attr">pod_annotations</span> = [<span class="string">&quot;io.katacontainers.*&quot;</span>]</span><br><span class="line">       <span class="attr">container_annotations</span> = [<span class="string">&quot;io.katacontainers.*&quot;</span>]</span><br><span class="line">       <span class="section">[plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes.kata.options]</span></span><br><span class="line">          <span class="attr">ConfigPath</span> = <span class="string">&quot;/opt/kata/share/defaults/kata-containers/configuration.toml&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="CRI-O"><a href="#CRI-O" class="headerlink" title="CRI-O"></a>CRI-O</h2><p><em>TODO</em></p>
<p>è‡³æ­¤ï¼Œå¯ä»¥å•ç‹¬é€šè¿‡ Container Manager å„è‡ªçš„å‘½ä»¤è¡Œè¿è¡Œ Kata Containersï¼Œä»¥ Containerd ä¸ºä¾‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo ctr image pull docker.io/library/ubuntu:latest</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo ctr run --runtime io.containerd.run.kata.v2 -t --<span class="built_in">rm</span> docker.io/library/ubuntu:latest hello sh -c <span class="string">&quot;free -h&quot;</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo ctr run --runtime io.containerd.run.kata.v2 -t --memory-limit 536870912 --<span class="built_in">rm</span> docker.io/library/ubuntu:latest hello sh -c <span class="string">&quot;free -h&quot;</span></span></span><br></pre></td></tr></table></figure>

<h1 id="ä¸-Kubernetes-é›†æˆ"><a href="#ä¸-Kubernetes-é›†æˆ" class="headerlink" title="ä¸ Kubernetes é›†æˆ"></a>ä¸ Kubernetes é›†æˆ</h1><p>Kubernetes ä¸­å¯¹äºè¿è¡Œæ—¶çš„é›†æˆæ˜¯é€šè¿‡ <a target="_blank" rel="noopener" href="https://kubernetes.io/docs/concepts/containers/runtime-class/">RuntimeClass</a> èµ„æºå¯¹è±¡ï¼Œä¾‹å¦‚</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">kind:</span> <span class="string">RuntimeClass</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">node.k8s.io/v1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">kata-containers</span></span><br><span class="line"><span class="attr">handler:</span> <span class="string">kata</span></span><br><span class="line"><span class="attr">overhead:</span></span><br><span class="line">  <span class="attr">podFixed:</span></span><br><span class="line">    <span class="attr">memory:</span> <span class="string">&quot;140Mi&quot;</span></span><br><span class="line">    <span class="attr">cpu:</span> <span class="string">&quot;250m&quot;</span></span><br><span class="line"><span class="attr">scheduling:</span></span><br><span class="line">  <span class="attr">nodeSelector:</span></span><br><span class="line">    <span class="attr">runtime:</span> <span class="string">kata</span></span><br></pre></td></tr></table></figure>

<h2 id="handler"><a href="#handler" class="headerlink" title="handler"></a>handler</h2><p>éœ€è¦å’Œ CRI ä¸­æ³¨å†Œçš„ handlerï¼ˆHANDLER_NAMEï¼‰ ä¿æŒä¸€è‡´ã€‚</p>
<p><strong>Containerd</strong></p>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes.$&#123;HANDLER_NAME&#125;]</span></span><br></pre></td></tr></table></figure>

<p><strong>CRI-O</strong></p>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[crio.runtime.runtimes.$&#123;HANDLER_NAME&#125;]</span></span><br></pre></td></tr></table></figure>

<h2 id="scheduling"><a href="#scheduling" class="headerlink" title="scheduling"></a>scheduling</h2><p>é€šè¿‡ä¸º RuntimeClass æŒ‡å®š scheduling å­—æ®µï¼Œ å¯ä»¥é€šè¿‡è®¾ç½®çº¦æŸï¼Œç¡®ä¿è¿è¡Œè¯¥ RuntimeClass çš„ Pod è¢«è°ƒåº¦åˆ°æ”¯æŒè¯¥ RuntimeClass çš„èŠ‚ç‚¹ä¸Šã€‚ å¦‚æœæœªè®¾ç½® schedulingï¼Œåˆ™å‡å®šæ‰€æœ‰èŠ‚ç‚¹å‡æ”¯æŒæ­¤ RuntimeClass ã€‚</p>
<p>ä¸ºäº†ç¡®ä¿ Pod ä¼šè¢«è°ƒåº¦åˆ°æ”¯æŒæŒ‡å®šè¿è¡Œæ—¶çš„èŠ‚ç‚¹ä¸Šï¼Œæ¯ä¸ªèŠ‚ç‚¹éœ€è¦è®¾ç½®ä¸€ä¸ªé€šç”¨çš„ label ç”¨äºè¢« runtimeclass.scheduling.nodeSelector æŒ‘é€‰ã€‚åœ¨ admission é˜¶æ®µï¼ŒRuntimeClass çš„ nodeSelector å°†ä¼šä¸ Pod çš„ nodeSelector åˆå¹¶ï¼Œå–äºŒè€…çš„äº¤é›†ã€‚å¦‚æœæœ‰å†²çªï¼ŒPod å°†ä¼šè¢«æ‹’ç»ã€‚</p>
<p>å¦‚æœèŠ‚ç‚¹éœ€è¦é˜»æ­¢æŸäº›éœ€è¦ç‰¹å®š RuntimeClass çš„ Podï¼Œå¯ä»¥åœ¨ tolerations ä¸­æŒ‡å®šã€‚ ä¸ nodeSelector ä¸€æ ·ï¼Œtolerations ä¹Ÿåœ¨ admission é˜¶æ®µä¸ Pod çš„ tolerations åˆå¹¶ï¼Œå–äºŒè€…çš„å¹¶é›†ã€‚</p>
<h2 id="overhead"><a href="#overhead" class="headerlink" title="overhead"></a>overhead</h2><p>åœ¨èŠ‚ç‚¹ä¸Šè¿è¡Œ Pod æ—¶ï¼ŒPod æœ¬èº«å ç”¨å¤§é‡ç³»ç»Ÿèµ„æºã€‚è¿™äº›èµ„æºæ˜¯è¿è¡Œ Pod å†…å®¹å™¨æ‰€éœ€èµ„æºçš„é™„åŠ èµ„æºã€‚Overhead æ˜¯ä¸€ä¸ªç‰¹æ€§ï¼Œç”¨äºè®¡ç®— Pod åŸºç¡€è®¾æ–½åœ¨å®¹å™¨è¯·æ±‚å’Œé™åˆ¶ä¹‹ä¸Šæ¶ˆè€—çš„èµ„æºã€‚</p>
<p>åœ¨ Kubernetes ä¸­ï¼ŒPod çš„å¼€é”€æ˜¯æ ¹æ®ä¸ Pod çš„ RuntimeClass ç›¸å…³è”çš„å¼€é”€åœ¨å‡†å…¥æ§åˆ¶æ—¶è®¾ç½®çš„ã€‚</p>
<p>å¦‚æœå¯ç”¨äº† Pod Overheadï¼Œåœ¨è°ƒåº¦ Pod æ—¶ï¼Œé™¤äº†è€ƒè™‘å®¹å™¨èµ„æºè¯·æ±‚çš„æ€»å’Œå¤–ï¼Œè¿˜è¦è€ƒè™‘ Pod å¼€é”€ã€‚ ç±»ä¼¼åœ°ï¼ŒKubelet å°†åœ¨ç¡®å®š Pod cgroups çš„å¤§å°å’Œæ‰§è¡Œ Pod é©±é€æ’åºæ—¶ä¹Ÿä¼šè€ƒè™‘ Pod å¼€é”€ã€‚</p>
<h1 id="VM-factory"><a href="#VM-factory" class="headerlink" title="VM factory"></a>VM factory</h1><h2 id="VMCache"><a href="#VMCache" class="headerlink" title="VMCache"></a>VMCache</h2><p>VMCache æ˜¯ä¸€é¡¹æ–°åŠŸèƒ½ï¼Œå¯åœ¨ä½¿ç”¨å‰å°† VM åˆ›å»ºä¸ºç¼“å­˜ã€‚å®ƒæœ‰åŠ©äºåŠ å¿«æ–°å®¹å™¨çš„åˆ›å»ºã€‚</p>
<p>è¯¥åŠŸèƒ½ç”±å€ŸåŠ© Unix socket é€šä¿¡çš„ä¸€ä¸ª gRPC Server å’Œä¸€äº› Client ç»„æˆã€‚</p>
<p>VMCache server å°†äº‹å…ˆåˆ›å»ºå¹¶ç¼“å­˜ä¸€äº› VMï¼Œå®ƒå°† VM è½¬æ¢ä¸º gRPC æ ¼å¼å¹¶åœ¨æ”¶åˆ° client è¯·æ±‚æ—¶è¿”å›ï¼›grpccache factory æ˜¯ VMCache å®¢æˆ·ç«¯ï¼Œå®ƒå°†è¯·æ±‚åˆ°çš„ gRPC æ ¼å¼çš„ VM å¹¶å°†å…¶è½¬æ¢å› VMã€‚å¦‚æœå¯ç”¨äº† VMCache åŠŸèƒ½ï¼ŒKata è¿è¡Œæ—¶åœ¨åˆ›å»ºæ–°çš„ sandbox æ—¶ä¼šå‘ grpccache è¯·æ±‚è·å– VMã€‚</p>
<p><strong>ä¸ VM tmplating çš„åŒºåˆ«</strong></p>
<p>VM tmplating å’Œ VMCache éƒ½æœ‰åŠ©äºåŠ å¿«æ–°å®¹å™¨çš„åˆ›å»ºã€‚</p>
<p>å½“å¯ç”¨ VM tmplating æ—¶ï¼Œé€šè¿‡ä»é¢„å…ˆåˆ›å»ºçš„æ¨¡æ¿ VM å…‹éš†æ¥åˆ›å»ºæ–°çš„ VMï¼Œå®ƒä»¬å°†ä»¥åªè¯»æ¨¡å¼å…±äº«ç›¸åŒçš„ initramfsã€å†…æ ¸å’Œ agent å†…å­˜ã€‚å› æ­¤ï¼Œå¦‚æœåœ¨åŒä¸€ä¸»æœºä¸Šè¿è¡Œè®¸å¤š Kata å®¹å™¨ï¼Œå®ƒä¼šèŠ‚çœå¤§é‡å†…å­˜ã€‚</p>
<p>è€Œ VMCache ä¸å®¹æ˜“å—åˆ°å…±äº«å†…å­˜ CVE çš„å½±å“ï¼Œå› ä¸ºæ¯ä¸ª VM ä¸å…±äº«å†…å­˜ã€‚</p>
<p><strong>å¦‚ä½•å¯ç”¨ VM Cache</strong></p>
<p>é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ä»¥ä¸‹é…ç½®é¡¹ï¼š</p>
<ul>
<li>[factory].vm_cache_number æŒ‡å®š VM ç¼“å­˜çš„ä¸ªæ•°</li>
<li>[factory].vm_cache_endpoint æŒ‡å®š socket åœ°å€ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰ï¼Œé»˜è®¤ä¸º &#x2F;var&#x2F;run&#x2F;kata-containers&#x2F;cache.sock</li>
</ul>
<p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ª VM æ¨¡æ¿ä¾›ä»¥åä½¿ç”¨ï¼Œé€šè¿‡ CTRL+C é€€å‡ºï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kata-runtime factory init</span></span><br></pre></td></tr></table></figure>

<p>åŒºåˆ«äº VM templatingï¼ŒVMCache åˆ›å»ºçš„ VM æ˜¯å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œè€Œéä¿å­˜åœ¨ [factory].template_path ç›®å½•ä¸‹</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kata-runtime factory status</span></span><br><span class="line">VM cache server pid = 38308</span><br><span class="line">VM pid = 38334 Cpu = 1 Memory = 2048MiB</span><br><span class="line">VM pid = 38331 Cpu = 1 Memory = 2048MiB</span><br><span class="line">VM pid = 38332 Cpu = 1 Memory = 2048MiB</span><br><span class="line">vm factory not enabled</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> -la /run/vc/vm</span></span><br><span class="line">a78a9744-5984-4e54-bda9-9b6280bf9a3f</span><br><span class="line">41648333-a4a3-48ee-b80b-f7c19e3081b1</span><br><span class="line">57d2dd69-0e73-4779-b23f-68ee8e4f66de</span><br><span class="line">template</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kata-runtime factory destroy</span></span><br><span class="line">vm factory destroyed</span><br></pre></td></tr></table></figure>

<p><strong>å·²çŸ¥é™åˆ¶</strong></p>
<ul>
<li>æ— æ³•ä¸ VM templating å…±å­˜</li>
<li>ä»…æ”¯æŒ QEMU ä½œä¸º hypervisor</li>
<li>[hypervisor].shared_fs ä¸º virtio-9pï¼ˆç¤¾åŒºæœ‰æ”¯æŒ virtio-fs çš„ææ¡ˆ <a target="_blank" rel="noopener" href="https://github.com/kata-containers/kata-containers/pull/4522%EF%BC%8C%E4%BD%86%E6%88%AA%E8%87%B3">https://github.com/kata-containers/kata-containers/pull/4522ï¼Œä½†æˆªè‡³</a> Kata 3.0.0 æš‚æœªåˆå…¥ï¼‰</li>
</ul>
<p><em>ç»éªŒè¯ï¼Œæˆªè‡³ Kata 3.0.0ï¼ŒVMCache å¹¶ä¸èƒ½å¼€ç®±å³ç”¨ï¼Œåœ¨ VMCache æµç¨‹ä¸­éƒ¨åˆ†å˜é‡ç¼ºå°‘èµ‹å€¼ï¼Œå¯¼è‡´ä»£ç æŠ¥é”™</em></p>
<h2 id="VM-templating"><a href="#VM-templating" class="headerlink" title="VM templating"></a>VM templating</h2><p>VM templating æ˜¯ Kata Containers çš„ä¸€é¡¹åŠŸèƒ½ï¼Œå¯ä»¥å€ŸåŠ©å…‹éš†æŠ€æœ¯åˆ›å»ºæ–°çš„ VMã€‚å¯ç”¨åï¼Œæ–°çš„ VM å°†é€šè¿‡ä»é¢„å…ˆåˆ›å»ºçš„æ¨¡æ¿è¿›è¡Œå…‹éš†æ¥åˆ›å»ºï¼Œå®ƒä»¬å°†ä»¥åªè¯»æ¨¡å¼å…±äº«ç›¸åŒçš„ initramfsã€å†…æ ¸å’Œ agent å†…å­˜ã€‚ç±»ä¼¼äºå†…æ ¸çš„ fork è¿›ç¨‹æ“ä½œï¼Œè¿™é‡Œ fork çš„æ˜¯ VMã€‚</p>
<p><strong>ä¸ VMCache çš„åŒºåˆ«</strong></p>
<p>VMCache å’Œ VM templating éƒ½æœ‰åŠ©äºåŠ å¿«æ–°å®¹å™¨çš„åˆ›å»ºã€‚</p>
<p>å¯ç”¨ VMCache åï¼ŒVMCache æœåŠ¡å™¨ä¼šåˆ›å»ºæ–°çš„ VMã€‚æ‰€ä»¥å®ƒä¸å®¹æ˜“å—åˆ°å…±äº«å†…å­˜ CVE çš„æ”»å‡»ï¼Œå› ä¸ºæ¯ä¸ª VM éƒ½ä¸å…±äº«å†…å­˜ã€‚</p>
<p>å¦‚æœåœ¨åŒä¸€ä¸»æœºä¸Šè¿è¡Œè®¸å¤š Kata å®¹å™¨ï¼ŒVM templating å¯ä»¥èŠ‚çœå¤§é‡å†…å­˜ã€‚</p>
<p><strong>ä¼˜åŠ¿</strong></p>
<p>å¦‚æœåœ¨åŒä¸€ä¸»æœºä¸Šè¿è¡Œè®¸å¤š Kata å®¹å™¨ï¼ŒVM templating æœ‰åŠ©äºåŠ å¿«æ–°å®¹å™¨çš„åˆ›å»ºå¹¶èŠ‚çœå¤§é‡å†…å­˜ã€‚å¦‚æœæ­£åœ¨è¿è¡Œé«˜å¯†åº¦å·¥ä½œè´Ÿè½½ï¼Œæˆ–è€…éå¸¸å…³å¿ƒå®¹å™¨å¯åŠ¨é€Ÿåº¦ï¼ŒVM templating å¯èƒ½éå¸¸æœ‰ç”¨ã€‚</p>
<p>åœ¨ä¸€ä¸ª<a target="_blank" rel="noopener" href="https://github.com/kata-containers/runtime/pull/303#issuecomment-395846767">ç¤ºä¾‹</a>ä¸­ï¼Œåˆ›å»ºäº† 100 ä¸ª Kata å®¹å™¨ï¼Œæ¯ä¸ªå®¹å™¨éƒ½æ‹¥æœ‰ 128MB çš„ VM å†…å­˜ï¼Œå¹¶ä¸”åœ¨å¯ç”¨ VM templating ç‰¹æ€§æ—¶æœ€ç»ˆæ€»å…±èŠ‚çœäº† 9GB çš„å†…å­˜ï¼Œè¿™å¤§çº¦æ˜¯ VM å†…å­˜æ€»é‡çš„ 72%ã€‚</p>
<p>åœ¨å¦ä¸€ä¸ª<a target="_blank" rel="noopener" href="https://gist.github.com/bergwolf/06974a3c5981494a40e2c408681c085d">ç¤ºä¾‹</a>ä¸­ï¼Œåˆ›å»ºäº† 10 ä¸ª Kata å®¹å™¨ï¼Œå¹¶è®¡ç®—äº†æ¯ä¸ªå®¹å™¨çš„å¹³å‡å¯åŠ¨é€Ÿåº¦ã€‚ç»“æœè¡¨æ˜ï¼ŒVM templating å°† Kata å®¹å™¨çš„åˆ›å»ºé€Ÿåº¦æé«˜äº† 38.68%ã€‚</p>
<p><strong>ä¸è¶³</strong></p>
<p>VM templating çš„ä¸€ä¸ªç¼ºç‚¹æ˜¯å®ƒæ— æ³•é¿å…è·¨ VM ä¾§é€šé“æ”»å‡»ï¼Œä¾‹å¦‚æœ€åˆé’ˆå¯¹ Linux KSM åŠŸèƒ½çš„ CVE-2015-2877ã€‚å¾—å‡ºçš„ç»“è®ºæ˜¯ï¼Œâ€œç›¸äº’ä¸ä¿¡ä»»çš„ç§Ÿæˆ·ä¹‹é—´ç”¨äºå†…å­˜ä¿æŠ¤çš„å…±äº«ç›´åˆ°å†™å…¥çš„æ–¹æ³•æœ¬è´¨ä¸Šæ˜¯å¯æ£€æµ‹çš„ä¿¡æ¯æ³„éœ²ï¼Œå¹¶ä¸”å¯ä»¥å½’ç±»ä¸ºæ½œåœ¨çš„è¢«è¯¯è§£çš„è¡Œä¸ºè€Œä¸æ˜¯æ¼æ´ã€‚â€å¦‚æœå¯¹æ­¤æ•æ„Ÿï¼Œä¸è¦ä½¿ç”¨ VM templating æˆ– KSMã€‚</p>
<p><strong>å¦‚ä½•å¯ç”¨ VM templating</strong></p>
<p>é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ä»¥ä¸‹é…ç½®é¡¹ï¼š</p>
<ul>
<li>hypervisor ä¸º qemuï¼Œä¸”ç‰ˆæœ¬ä¸º v4.1.0 ä»¥ä¸Š</li>
<li>[factory].enable_template è®¾ä¸º true</li>
<li>VM é•œåƒä¸º initrd ç±»å‹ï¼Œå³ä¸º [hypervisor].initrd</li>
<li>[hypervisor].shared_fs ä¸º virtio-9p</li>
</ul>
<p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ª VM æ¨¡æ¿ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kata-runtime factory init</span></span><br><span class="line">vm factory initialized</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºçš„æ¨¡æ¿é»˜è®¤ä¿å­˜åœ¨ &#x2F;run&#x2F;vc&#x2F;vm&#x2F;templateï¼Œå¯ä»¥é€šè¿‡ [factory].template_path æŒ‡å®šï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> /run/vc/vm/template</span></span><br><span class="line">memory  state</span><br></pre></td></tr></table></figure>

<p>æ¨¡æ¿é€šè¿‡ä»¥ä¸‹å‘½ä»¤é”€æ¯ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kata-runtime factory destroy</span></span><br><span class="line">vm factory destroyed</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä¸æƒ³æ‰‹åŠ¨è°ƒç”¨ kata-runtime factory initï¼Œåœ¨å¯ç”¨ VM templating åï¼Œé»˜è®¤åˆ›å»ºçš„ç¬¬ä¸€ä¸ª Kata å®¹å™¨å°†è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª VM æ¨¡æ¿ã€‚</p>
<h1 id="kata-runtime"><a href="#kata-runtime" class="headerlink" title="kata-runtime"></a>kata-runtime</h1><p>kata-runtime æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œæ”¯æŒä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<h2 id="check-kata-check"><a href="#check-kata-check" class="headerlink" title="check (kata-check)"></a>check (kata-check)</h2><p>æ£€æµ‹å½“å‰ç¯å¢ƒæ˜¯å¦å¯ä»¥è¿è¡Œ Kata Containers ä»¥åŠç‰ˆæœ¬æ˜¯å¦æ­£ç¡®ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kata-runtime check --verbose</span></span><br><span class="line">INFO[0000] IOMMUPlatform is disabled by default.        </span><br><span class="line">WARN[0000] Not running network checks as super user      arch=amd64 name=kata-runtime pid=29825 source=runtime</span><br><span class="line">INFO[0000] CPU property found                            arch=amd64 description=&quot;Intel Architecture CPU&quot; name=GenuineIntel pid=29825 source=runtime type=attribute</span><br><span class="line">INFO[0000] CPU property found                            arch=amd64 description=&quot;Virtualization support&quot; name=vmx pid=29825 source=runtime type=flag</span><br><span class="line">INFO[0000] CPU property found                            arch=amd64 description=&quot;64Bit CPU&quot; name=lm pid=29825 source=runtime type=flag</span><br><span class="line">INFO[0000] CPU property found                            arch=amd64 description=SSE4.1 name=sse4_1 pid=29825 source=runtime type=flag</span><br><span class="line">INFO[0000] kernel property found                         arch=amd64 description=&quot;Intel KVM&quot; name=kvm_intel pid=29825 source=runtime type=module</span><br><span class="line">INFO[0000] kernel property found                         arch=amd64 description=&quot;Kernel-based Virtual Machine&quot; name=kvm pid=29825 source=runtime type=module</span><br><span class="line">INFO[0000] kernel property found                         arch=amd64 description=&quot;Host kernel accelerator for virtio&quot; name=vhost pid=29825 source=runtime type=module</span><br><span class="line">INFO[0000] kernel property found                         arch=amd64 description=&quot;Host kernel accelerator for virtio network&quot; name=vhost_net pid=29825 source=runtime type=module</span><br><span class="line">INFO[0000] kernel property found                         arch=amd64 description=&quot;Host Support for Linux VM Sockets&quot; name=vhost_vsock pid=29825 source=runtime type=module</span><br><span class="line">System is capable of running Kata Containers</span><br><span class="line">INFO[0000] device available                              arch=amd64 check-type=full device=/dev/kvm name=kata-runtime pid=29825 source=runtime</span><br><span class="line">INFO[0000] feature available                             arch=amd64 check-type=full feature=create-vm name=kata-runtime pid=29825 source=runtime</span><br><span class="line">System can currently create Kata Containers</span><br></pre></td></tr></table></figure>

<p>å¯é€‰çš„ flags åŒ…æ‹¬ï¼š</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>â€“check-version-only</td>
<td>ä»…å¯¹æ¯”å‰ä½¿ç”¨ç‰ˆæœ¬å’Œæœ€æ–°å¯ç”¨ç‰ˆæœ¬ï¼ˆéœ€è¦ç½‘ç»œæ”¯æŒï¼Œä¸”é root ç”¨æˆ·ï¼‰</td>
</tr>
<tr>
<td>â€“include-all-releases</td>
<td>åŒ…å«è¿‡æ»¤é¢„å‘å¸ƒçš„ç‰ˆæœ¬</td>
</tr>
<tr>
<td>â€“no-network-checks, -n</td>
<td>ä¸å€ŸåŠ©ç½‘ç»œæ‰§è¡Œæ£€æµ‹ï¼Œè¯¥å‚æ•°ç­‰ä»·äºè®¾ç½® KATA_CHECK_NO_NETWORK ç¯å¢ƒå˜é‡</td>
</tr>
<tr>
<td>â€“only-list-releases</td>
<td>ä»…åˆ—å‡ºè¾ƒæ–°çš„å¯ç”¨ç‰ˆæœ¬ï¼ˆéœ€è¦ç½‘ç»œæ”¯æŒï¼Œä¸”é root ç”¨æˆ·ï¼‰</td>
</tr>
<tr>
<td>â€“strict, -s</td>
<td>è¿›è¡Œä¸¥æ ¼æ£€æŸ¥</td>
</tr>
<tr>
<td>â€“verbose, -v</td>
<td>å±•ç¤ºè¯¦ç»†çš„æ£€æŸ¥é¡¹</td>
</tr>
</tbody></table>
<h2 id="env-kata-env"><a href="#env-kata-env" class="headerlink" title="env (kata-env)"></a>env (kata-env)</h2><p>Kata Containers é…ç½®å±•ç¤ºï¼Œé»˜è®¤è¾“å‡ºæ ¼å¼ä¸º TOMLã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kata-runtime <span class="built_in">env</span></span> </span><br><span class="line">[Kernel]</span><br><span class="line">  Path = &quot;/opt/kata/share/kata-containers/vmlinux-5.19.2-96&quot;</span><br><span class="line">  Parameters = &quot;systemd.unit=kata-containers.target systemd.mask=systemd-networkd.service systemd.mask=systemd-networkd.socket scsi_mod.scan=none agent.log=debug agent.debug_console agent.debug_console_vport=1026&quot;</span><br><span class="line"></span><br><span class="line">[Meta]</span><br><span class="line">  Version = &quot;1.0.26&quot;</span><br><span class="line"></span><br><span class="line">[Image]</span><br><span class="line">  Path = &quot;/opt/kata/share/kata-containers/kata-clearlinux-latest.image&quot;</span><br><span class="line"></span><br><span class="line">[Initrd]</span><br><span class="line">  Path = &quot;&quot;</span><br><span class="line"></span><br><span class="line">[Hypervisor]</span><br><span class="line">  MachineType = &quot;q35&quot;</span><br><span class="line">  Version = &quot;QEMU emulator version 6.2.0 (kata-static)\nCopyright (c) 2003-2021 Fabrice Bellard and the QEMU Project developers&quot;</span><br><span class="line">  Path = &quot;/opt/kata/bin/qemu-system-x86_64&quot;</span><br><span class="line">  BlockDeviceDriver = &quot;virtio-scsi&quot;</span><br><span class="line">  EntropySource = &quot;/dev/urandom&quot;</span><br><span class="line">  SharedFS = &quot;virtio-fs&quot;</span><br><span class="line">  VirtioFSDaemon = &quot;/opt/kata/libexec/virtiofsd&quot;</span><br><span class="line">  SocketPath = &quot;&quot;</span><br><span class="line">  Msize9p = 8192</span><br><span class="line">  MemorySlots = 10</span><br><span class="line">  PCIeRootPort = 2</span><br><span class="line">  HotplugVFIOOnRootBus = true</span><br><span class="line">  Debug = true</span><br><span class="line"></span><br><span class="line">[Runtime]</span><br><span class="line">  Path = &quot;/usr/local/bin/kata-runtime&quot;</span><br><span class="line">  Debug = true</span><br><span class="line">  Trace = false</span><br><span class="line">  DisableGuestSeccomp = true</span><br><span class="line">  DisableNewNetNs = false</span><br><span class="line">  SandboxCgroupOnly = false</span><br><span class="line">  [Runtime.Config]</span><br><span class="line">    Path = &quot;/etc/kata-containers/configuration.toml&quot;</span><br><span class="line">  [Runtime.Version]</span><br><span class="line">    OCI = &quot;1.0.2-dev&quot;</span><br><span class="line">    [Runtime.Version.Version]</span><br><span class="line">      Semver = &quot;3.0.0&quot;</span><br><span class="line">      Commit = &quot;e2a8815ba46360acb8bf89a2894b0d437dc8548a-dirty&quot;</span><br><span class="line">      Major = 3</span><br><span class="line">      Minor = 0</span><br><span class="line">      Patch = 0</span><br><span class="line"></span><br><span class="line">[Host]</span><br><span class="line">  Kernel = &quot;4.18.0-305.43.25.ar.el7.x86_64&quot;</span><br><span class="line">  Architecture = &quot;amd64&quot;</span><br><span class="line">  VMContainerCapable = true</span><br><span class="line">  SupportVSocks = true</span><br><span class="line">  [Host.Distro]</span><br><span class="line">    Name = &quot;CentOS Linux&quot;</span><br><span class="line">    Version = &quot;7&quot;</span><br><span class="line">  [Host.CPU]</span><br><span class="line">    Vendor = &quot;GenuineIntel&quot;</span><br><span class="line">    Model = &quot;QEMU Virtual CPU version (cpu64-rhel6)&quot;</span><br><span class="line">    CPUs = 8</span><br><span class="line">  [Host.Memory]</span><br><span class="line">    Total = 12057632</span><br><span class="line">    Free = 3352124</span><br><span class="line">    Available = 8508112</span><br><span class="line"></span><br><span class="line">[Agent]</span><br><span class="line">  Debug = true</span><br><span class="line">  Trace = false</span><br></pre></td></tr></table></figure>

<p>å¯é€‰çš„ flags åŒ…æ‹¬</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>â€“json</td>
<td>ä»¥ JSON æ ¼å¼å±•ç¤º</td>
</tr>
</tbody></table>
<h2 id="exec"><a href="#exec" class="headerlink" title="exec"></a>exec</h2><p>å€ŸåŠ© debug consoleï¼Œè¿›å…¥ VM æ§åˆ¶å°ï¼Œéœ€è¦ [agent].debug_console_enabled è®¾ç½®ä¸º trueã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯¹äº Pod è€Œè¨€æ˜¯å…¶ SandboxID</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kata-runtime <span class="built_in">exec</span> 27ab74433f11c0b64e404a841d5e2f8296a723ebfa4e598b4d9d32871173b82c</span></span><br></pre></td></tr></table></figure>

<p>å¯é€‰çš„ flags åŒ…æ‹¬</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>â€“kata-debug-port</td>
<td>debug console ç›‘å¬çš„ç«¯å£ï¼Œé»˜è®¤ä¸º 1026 æˆ–è€… 0</td>
</tr>
</tbody></table>
<h2 id="metrics"><a href="#metrics" class="headerlink" title="metrics"></a>metrics</h2><p>æ”¶é›†ä¸ç”¨äºè¿è¡Œ sandbox çš„åŸºç¡€è®¾æ–½ç›¸å…³çš„æŒ‡æ ‡ï¼Œä¾‹å¦‚ runtimeã€agentã€hypervisor ç­‰ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯¹äº Pod è€Œè¨€æ˜¯å…¶ SandboxID</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kata-runtime metrics 27ab74433f11c0b64e404a841d5e2f8296a723ebfa4e598b4d9d32871173b82c</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">HELP kata_hypervisor_fds Open FDs <span class="keyword">for</span> hypervisor.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">TYPE kata_hypervisor_fds gauge</span></span><br><span class="line">kata_hypervisor_fds 122</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">HELP kata_hypervisor_io_stat Process IO statistics.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">TYPE kata_hypervisor_io_stat gauge</span></span><br><span class="line">kata_hypervisor_io_stat&#123;item=&quot;cancelledwritebytes&quot;&#125; 0</span><br><span class="line">kata_hypervisor_io_stat&#123;item=&quot;rchar&quot;&#125; 5.915546e+06</span><br><span class="line">kata_hypervisor_io_stat&#123;item=&quot;readbytes&quot;&#125; 1.1665408e+07</span><br><span class="line">kata_hypervisor_io_stat&#123;item=&quot;syscr&quot;&#125; 95522</span><br><span class="line">kata_hypervisor_io_stat&#123;item=&quot;syscw&quot;&#125; 202276</span><br><span class="line">kata_hypervisor_io_stat&#123;item=&quot;wchar&quot;&#125; 3.715404e+06</span><br><span class="line">kata_hypervisor_io_stat&#123;item=&quot;writebytes&quot;&#125; 2.097152e+06</span><br></pre></td></tr></table></figure>

<h2 id="direct-volume"><a href="#direct-volume" class="headerlink" title="direct-volume"></a>direct-volume</h2><p>ç®¡ç† Kata Containers çš„ç›´é€šå·ã€‚*å…·ä½“ä½¿ç”¨æ–¹å¼å‚è€ƒ <strong>Kata Containers Block Volume ç›´é€š</strong>è¯´æ˜ã€‚*</p>
<p><strong>add</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kata-runtime direct-volume add --volume-path /var/lib/kubelet/pods/8c3d29ad-84b8-45f0-9fcc-8e16778cb3cb/volumes/kubernetes.io~csi/pvc-a950ed68-622c-4ec4-81fa-506f16de2196/mount --mount-info \&#123;\&quot;volume-type\&quot;:\&quot;block\&quot;,\&quot;device\&quot;:\&quot;/dev/sdm\&quot;,\&quot;fstype\&quot;:\&quot;xfs\&quot;\&#125;</span></span><br></pre></td></tr></table></figure>

<p>å¯é€‰çš„ flags åŒ…æ‹¬</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>â€“volume-path</td>
<td>å¾…æ“ä½œçš„ç›®æ ‡å·è·¯å¾„</td>
</tr>
<tr>
<td>â€“mount-info</td>
<td>ç®¡ç†å·æŒ‚è½½çš„è¯¦æƒ…ä¿¡æ¯</td>
</tr>
</tbody></table>
<p><strong>remove</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kata-runtime direct-volume delete --volume-path /var/lib/kubelet/pods/8c3d29ad-84b8-45f0-9fcc-8e16778cb3cb/volumes/kubernetes.io~csi/pvc-a950ed68-622c-4ec4-81fa-506f16de2196/mount</span></span><br></pre></td></tr></table></figure>

<p>å¯é€‰çš„ flags åŒ…æ‹¬</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>â€“volume-path</td>
<td>å¾…æ“ä½œçš„ç›®æ ‡å·è·¯å¾„</td>
</tr>
</tbody></table>
<p><strong>stats</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kata-runtime direct-volume stats --volume-path /var/lib/kubelet/pods/8c3d29ad-84b8-45f0-9fcc-8e16778cb3cb/volumes/kubernetes.io~csi/pvc-a950ed68-622c-4ec4-81fa-506f16de2196/mount</span></span><br></pre></td></tr></table></figure>

<p>å¯é€‰çš„ flags åŒ…æ‹¬</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>â€“volume-path</td>
<td>å¾…æ“ä½œçš„ç›®æ ‡å·è·¯å¾„</td>
</tr>
</tbody></table>
<p><strong>resize</strong></p>
<p><em>æˆªè‡³ Kata Containers 3.0.0ï¼Œç¤¾åŒºä»æœªå®ç° VM ä¸­ Kata agent çš„é€»è¾‘</em></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kata-runtime direct-volume resize --volume-path /var/lib/kubelet/pods/8c3d29ad-84b8-45f0-9fcc-8e16778cb3cb/volumes/kubernetes.io~csi/pvc-a950ed68-622c-4ec4-81fa-506f16de2196/mount --size 1756519562</span></span><br></pre></td></tr></table></figure>

<p>å¯é€‰çš„ flags åŒ…æ‹¬</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>â€“volume-path</td>
<td>å¾…æ“ä½œçš„ç›®æ ‡å·è·¯å¾„</td>
</tr>
<tr>
<td>â€“size</td>
<td>è°ƒæ•´åçš„é¢„æœŸå·å¤§å°ï¼ˆå•ä½ä¸ºï¼šByteï¼‰</td>
</tr>
</tbody></table>
<h2 id="factory-1"><a href="#factory-1" class="headerlink" title="factory"></a>factory</h2><p>ç®¡ç† Kata Containers çš„ VM factoryã€‚<em>å…·ä½“ä½¿ç”¨æ–¹å¼å‚è€ƒ <strong>VM factory</strong> è¯´æ˜ã€‚</em></p>
<p><strong>init</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kata-runtime factory init</span></span><br><span class="line">vm factory initialized</span><br></pre></td></tr></table></figure>

<p><strong>status</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kata-runtime factory status</span></span><br><span class="line">vm factory is on</span><br></pre></td></tr></table></figure>

<p><strong>destroy</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kata-runtime factory destroy</span></span><br><span class="line">vm factory destroyed</span><br></pre></td></tr></table></figure>

<h2 id="iptables"><a href="#iptables" class="headerlink" title="iptables"></a>iptables</h2><p>ç®¡ç† VM ä¸­çš„ iptables ä¿¡æ¯ã€‚</p>
<p><strong>get</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kata-runtime iptables get --sandbox-id xxx --v6</span></span><br></pre></td></tr></table></figure>

<p>å¯é€‰çš„ flags åŒ…æ‹¬</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>â€“sandbox-id</td>
<td>å¾…æ“ä½œçš„ Sandbox ID</td>
</tr>
<tr>
<td>â€“v6</td>
<td>è·å– IPV6 çš„ iptables</td>
</tr>
</tbody></table>
<p><strong>set</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kata-runtime iptables <span class="built_in">set</span> --sandbox-id xxx --v6 ./iptables</span></span><br></pre></td></tr></table></figure>

<p>å¯é€‰çš„ flags åŒ…æ‹¬</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>â€“sandbox-id</td>
<td>å¾…æ“ä½œçš„ Sandbox ID</td>
</tr>
<tr>
<td>â€“v6</td>
<td>è®¾ç½® IPV6 çš„ iptables</td>
</tr>
</tbody></table>
<h1 id="kata-monitor"><a href="#kata-monitor" class="headerlink" title="kata-monitor"></a>kata-monitor</h1><p>Kata monitor æ˜¯ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ï¼Œèƒ½å¤Ÿæ”¶é›†å’Œæš´éœ²åœ¨åŒä¸€ host ä¸Šè¿è¡Œçš„æ‰€æœ‰ Kata å®¹å™¨å·¥ä½œè´Ÿè½½ç›¸å…³çš„æŒ‡æ ‡ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kata-monitor</span></span><br><span class="line">INFO[0000] announce                                      app=kata-monitor arch=amd64 git-commit=fcad969e5200607df3b0b31983cc64488e156e99 go-version=go1.16.10 listen-address=&quot;127.0.0.1:8090&quot; log-level=info os=linux runtime-endpoint=/run/containerd/containerd.sock version=0.3.0</span><br></pre></td></tr></table></figure>

<p>å¯é€‰çš„ flags åŒ…æ‹¬</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>â€“listen-address</td>
<td>ç›‘å¬ HTTP è¯·æ±‚çš„åœ°å€ï¼Œé»˜è®¤ä¸º 127.0.0.1:8090</td>
</tr>
<tr>
<td>â€“log-level</td>
<td>æœåŠ¡æ—¥å¿—çº§åˆ«ï¼Œå¯é€‰æœ‰ trace&#x2F;debug&#x2F;info&#x2F;warn&#x2F;error&#x2F;fatal&#x2F;panicï¼Œé»˜è®¤ä¸º info</td>
</tr>
<tr>
<td>â€“runtime-endpoint</td>
<td>CRI å®¹å™¨è¿è¡Œæ—¶æœåŠ¡çš„ socket åœ°å€ï¼Œé»˜è®¤ä¸º &#x2F;run&#x2F;containerd&#x2F;containerd.sock</td>
</tr>
</tbody></table>
</div><div class="article-licensing box"><div class="licensing-title"><p>ã€Œ Kata Containers ã€å¿«é€Ÿå¼€å§‹</p><p><a href="http://shenxianghong.github.io/2021/04/15/2021-04-15 Kata Containers å¿«é€Ÿå¼€å§‹/">http://shenxianghong.github.io/2021/04/15/2021-04-15 Kata Containers å¿«é€Ÿå¼€å§‹/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Shen Xianghong</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2021-04-15</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2023-06-19</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i>Â <a class="link-muted" rel="tag" href="/tags/Kata-Containers/">Kata Containers </a></div></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/04/22/2021-04-22%20Kata%20Containers%20%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">ã€Œ Kata Containers ã€æºç ç¼–è¯‘</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/04/06/2021-04-06%20Kata%20Containers%20%E6%9E%B6%E6%9E%84%E4%B8%8E%E7%BB%84%E4%BB%B6%E6%A6%82%E8%BF%B0/"><span class="level-item">ã€Œ Kata Containers ã€æ¶æ„ä¸ç»„ä»¶æ¦‚è¿°</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://avatars.githubusercontent.com/u/35031258?v=4" alt="ğŸ¾Corgi"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">ğŸ¾Corgi</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">54</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">7</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">10</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/shenxianghong" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Youtube" href="https://youtube.com"><i class="fab fa-youtube"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Bilibili" href="https://bilibili.com"><i class="fab fa-bilibili"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Reddit" href="https://reddit.com"><i class="fab fa-reddit"></i></a></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://google.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Google</span></span><span class="level-right"><span class="level-item tag">google.com</span></span></a></li><li><a class="level is-mobile" href="https://poe.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Poe</span></span><span class="level-right"><span class="level-item tag">poe.com</span></span></a></li></ul></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#å®‰è£…"><span class="level-left"><span class="level-item">1</span><span class="level-item">å®‰è£…</span></span></a></li><li><a class="level is-mobile" href="#é…ç½®å‚æ•°"><span class="level-left"><span class="level-item">2</span><span class="level-item">é…ç½®å‚æ•°</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#hypervisor"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">hypervisor</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#QEMU"><span class="level-left"><span class="level-item">2.1.1</span><span class="level-item">QEMU</span></span></a></li></ul></li><li><a class="level is-mobile" href="#factory"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">factory</span></span></a></li><li><a class="level is-mobile" href="#runtime"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">runtime</span></span></a></li><li><a class="level is-mobile" href="#annotation-å‚æ•°æ‰©å±•"><span class="level-left"><span class="level-item">2.4</span><span class="level-item">annotation å‚æ•°æ‰©å±•</span></span></a></li></ul></li><li><a class="level is-mobile" href="#ä¸-Container-Manager-é›†æˆ"><span class="level-left"><span class="level-item">3</span><span class="level-item">ä¸ Container Manager é›†æˆ</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Docker"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">Docker</span></span></a></li><li><a class="level is-mobile" href="#Containerd"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">Containerd</span></span></a></li><li><a class="level is-mobile" href="#CRI-O"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">CRI-O</span></span></a></li></ul></li><li><a class="level is-mobile" href="#ä¸-Kubernetes-é›†æˆ"><span class="level-left"><span class="level-item">4</span><span class="level-item">ä¸ Kubernetes é›†æˆ</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#handler"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">handler</span></span></a></li><li><a class="level is-mobile" href="#scheduling"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">scheduling</span></span></a></li><li><a class="level is-mobile" href="#overhead"><span class="level-left"><span class="level-item">4.3</span><span class="level-item">overhead</span></span></a></li></ul></li><li><a class="level is-mobile" href="#VM-factory"><span class="level-left"><span class="level-item">5</span><span class="level-item">VM factory</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#VMCache"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">VMCache</span></span></a></li><li><a class="level is-mobile" href="#VM-templating"><span class="level-left"><span class="level-item">5.2</span><span class="level-item">VM templating</span></span></a></li></ul></li><li><a class="level is-mobile" href="#kata-runtime"><span class="level-left"><span class="level-item">6</span><span class="level-item">kata-runtime</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#check-kata-check"><span class="level-left"><span class="level-item">6.1</span><span class="level-item">check (kata-check)</span></span></a></li><li><a class="level is-mobile" href="#env-kata-env"><span class="level-left"><span class="level-item">6.2</span><span class="level-item">env (kata-env)</span></span></a></li><li><a class="level is-mobile" href="#exec"><span class="level-left"><span class="level-item">6.3</span><span class="level-item">exec</span></span></a></li><li><a class="level is-mobile" href="#metrics"><span class="level-left"><span class="level-item">6.4</span><span class="level-item">metrics</span></span></a></li><li><a class="level is-mobile" href="#direct-volume"><span class="level-left"><span class="level-item">6.5</span><span class="level-item">direct-volume</span></span></a></li><li><a class="level is-mobile" href="#factory-1"><span class="level-left"><span class="level-item">6.6</span><span class="level-item">factory</span></span></a></li><li><a class="level is-mobile" href="#iptables"><span class="level-left"><span class="level-item">6.7</span><span class="level-item">iptables</span></span></a></li></ul></li><li><a class="level is-mobile" href="#kata-monitor"><span class="level-left"><span class="level-item">7</span><span class="level-item">kata-monitor</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Container-Runtime/"><span class="level-start"><span class="level-item">Container Runtime</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li><li><a class="level is-mobile" href="/categories/Disaster-Recovery/"><span class="level-start"><span class="level-item">Disaster Recovery</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/"><span class="level-start"><span class="level-item">Programming</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Scheduling-Orchestration/"><span class="level-start"><span class="level-item">Scheduling &amp; Orchestration</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/categories/Scheduling-Orchestration/Kubernetes/"><span class="level-start"><span class="level-item">Kubernetes</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Serverless/"><span class="level-start"><span class="level-item">Serverless</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Service-Mesh/"><span class="level-start"><span class="level-item">Service Mesh</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li></ul></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="ğŸ¾Corgi" height="28"></a><p class="is-size-7"><span>&copy; 2023 Shen Xianghong</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p><p class="is-size-7"><br/>And did you get what you wanted from this life, even so?</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><script src="/js/night.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>