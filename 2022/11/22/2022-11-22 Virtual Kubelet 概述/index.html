<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>ã€Œ Virtual Kubelet ã€Virtual Kubelet æ¦‚è¿° - ğŸ¾Corgi</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="ğŸ¾Corgi"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="ğŸ¾Corgi"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Virtual Kubelet çš„æ¶æ„æ¦‚è¿°ã€Provider å®ç°ä»¥åŠå®è·µæ“ä½œ"><meta property="og:type" content="blog"><meta property="og:title" content="ã€Œ Virtual Kubelet ã€Virtual Kubelet æ¦‚è¿°"><meta property="og:url" content="http://shenxianghong.github.io/2022/11/22/2022-11-22%20Virtual%20Kubelet%20%E6%A6%82%E8%BF%B0/"><meta property="og:site_name" content="ğŸ¾Corgi"><meta property="og:description" content="Virtual Kubelet çš„æ¶æ„æ¦‚è¿°ã€Provider å®ç°ä»¥åŠå®è·µæ“ä½œ"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://picsum.photos/0?sig=20221122"><meta property="article:published_time" content="2022-11-21T16:00:00.000Z"><meta property="article:modified_time" content="2023-05-04T00:54:28.334Z"><meta property="article:author" content="Shen Xianghong"><meta property="article:tag" content="Virtual Kubelet"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://picsum.photos/0?sig=20221122"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://shenxianghong.github.io/2022/11/22/2022-11-22%20Virtual%20Kubelet%20%E6%A6%82%E8%BF%B0/"},"headline":"ã€Œ Virtual Kubelet ã€Virtual Kubelet æ¦‚è¿°","image":[],"datePublished":"2022-11-21T16:00:00.000Z","dateModified":"2023-05-04T00:54:28.334Z","author":{"@type":"Person","name":"Shen Xianghong"},"publisher":{"@type":"Organization","name":"ğŸ¾Corgi","logo":{"@type":"ImageObject","url":"http://shenxianghong.github.io/img/logo.svg"}},"description":"Virtual Kubelet çš„æ¶æ„æ¦‚è¿°ã€Provider å®ç°ä»¥åŠå®è·µæ“ä½œ"}</script><link rel="canonical" href="http://shenxianghong.github.io/2022/11/22/2022-11-22%20Virtual%20Kubelet%20%E6%A6%82%E8%BF%B0/"><link rel="alternate" href="/atom.xml" title="ğŸ¾Corgi" type="application/atom+xml"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/xcode.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="ğŸ¾Corgi" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a></div><div class="navbar-end"><a class="navbar-item night" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="https://picsum.photos/0?sig=20221122" alt="ã€Œ Virtual Kubelet ã€Virtual Kubelet æ¦‚è¿°"></span></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="fa fa-calendar"></i>Â <time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2022-11-22</time></span><span class="level-item is-hidden-mobile"><i class="fa fa-calendar-check"></i>Â <time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2023-05-04</time></span><span class="level-item"><i class="far fa-folder-open"></i>Â <a class="link-muted" href="/categories/Overview/">Overview</a></span><span class="level-item"><i class="far fa-clock"></i>Â 32 minutes read (About 4803 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">ã€Œ Virtual Kubelet ã€Virtual Kubelet æ¦‚è¿°</h1><div class="content"><div align=center><img width="150" style="border: 0px" src="https://virtual-kubelet.io/img/color-logo.png"></div>

<hr>
<blockquote>
<p>Based on <strong>v1.7.0</strong></p>
</blockquote>
<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><blockquote>
<p>Kubernetes API on top, programmable back.</p>
</blockquote>
<p>Virtual Kubeletï¼ˆVKï¼‰ æ˜¯ Kubernetes ä¸­ Kubelet çš„å…¸å‹ç‰¹æ€§å®ç°ï¼Œå‘ä¸Šä¼ªè£…æˆ Kubeletï¼Œä»è€Œæ¨¡æ‹Ÿå‡º Node å¯¹è±¡ï¼Œå¯¹æ¥ Kubernetes çš„åŸç”Ÿèµ„æºå¯¹è±¡ã€‚å‘ä¸‹æä¾› APIï¼Œå¯å¯¹æ¥å…¶ä»–èµ„æºç®¡ç†å¹³å°æä¾›çš„ Providerï¼Œä¸åŒçš„å¹³å°é€šè¿‡å®ç° Virtual Kubelet å®šä¹‰çš„æ–¹æ³•ï¼Œå…è®¸èŠ‚ç‚¹ç”±å…¶å¯¹åº”çš„ Provider æä¾›ï¼Œå¦‚ ACIã€AWS Fargateã€IoT Edgeã€Tensile Kube ç­‰ã€‚Virtual Kubelet çš„ä¸»è¦åœºæ™¯æ˜¯å°† Kubernetes API æ‰©å±•åˆ° Serverless å®¹å™¨å¹³å°ï¼ˆå¦‚ ACI å’Œ Fargateï¼‰æˆ–è€…æ‰©å±•åˆ°å¦‚ Docker Swarmã€Openstack ZUN ç­‰å®¹å™¨å¹³å°ä¸­ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ Provider çº³ç®¡å…¶ä»– Kubernetes é›†ç¾¤ï¼Œç”šè‡³æ˜¯åŸç”Ÿçš„ IAAS å¹³å°ï¼ˆå¦‚ VMwareã€Openstack ç­‰ã€‚åœ¨ç¤¾åŒºå®—æ—¨ä¸­ï¼ŒVirtual Kubelet ä¸æ˜¯ç”¨æ¥å®ç°é›†ç¾¤è”é‚¦çš„æ‰‹æ®µã€‚</p>
<p>Virtual Kubelet å…·æœ‰å¯æ’æ‹”æ¶æ„å’Œç›´æ¥ä½¿ç”¨ Kubernetes åŸè¯­çš„ç‰¹ç‚¹ï¼Œæ›´æ˜“äºæ„å»ºã€‚</p>
<h1 id="æ¶æ„"><a href="#æ¶æ„" class="headerlink" title="æ¶æ„"></a>æ¶æ„</h1><div align=center><img width="800" style="border: 0px" src="https://raw.githubusercontent.com/virtual-kubelet/virtual-kubelet/master/website/static/img/diagram.svg"></div>

<p><strong>ä¸ä¼ ç»Ÿ Kubelet çš„åŒºåˆ«</strong></p>
<ul>
<li>ä¼ ç»Ÿçš„ Kubelet å®ç°äº†æ‰€åœ¨èŠ‚ç‚¹çš„ Pod å’Œå®¹å™¨çš„æ“ä½œè¡Œä¸º</li>
<li>Virtual Kubelet ä»¥èŠ‚ç‚¹çš„å½¢å¼æ³¨å†Œï¼Œå…è®¸å¼€å‘è€…ä»¥è‡ªå®šä¹‰çš„è¡Œä¸ºéƒ¨ç½² Pod å’Œå®¹å™¨</li>
</ul>
<p><strong>å½“å‰æ”¯æŒçš„ Kubernetes ç‰¹æ€§</strong></p>
<ul>
<li>åˆ›å»ºã€åˆ é™¤å’Œæ›´æ–° Pod</li>
<li>å®¹å™¨æ—¥å¿—ã€ç®¡ç†å’ŒæŒ‡æ ‡</li>
<li>è·å– Pod ä»¥åŠçŠ¶æ€</li>
<li>èŠ‚ç‚¹åœ°å€ã€èŠ‚ç‚¹å®¹é‡ã€èŠ‚ç‚¹å®ˆæŠ¤è¿›ç¨‹ç«¯ç‚¹</li>
<li>ç®¡ç†æ“ä½œç³»ç»Ÿ</li>
<li>æºå¸¦ç§æœ‰è™šæ‹Ÿç½‘ç»œ</li>
</ul>
<h1 id="Providers"><a href="#Providers" class="headerlink" title="Providers"></a>Providers</h1><p>Virtual Kubelet ä¸“æ³¨äºæä¾›ä¸€ä¸ªåº“ï¼Œç”¨æˆ·å¯ä»¥åœ¨é¡¹ç›®ä¸­ä½¿ç”¨è¯¥åº“æ¥æ„å»ºè‡ªå®šä¹‰ Kubernetes èŠ‚ç‚¹ agentã€‚</p>
<p>è¯¥é¡¹ç›®å…·æœ‰ä¸€ä¸ªå¯æ’æ‹”çš„ Provider æ¥å£ï¼Œå¼€å‘è€…å¯ä»¥å®ç°è¯¥æ¥å£æ¥å®šä¹‰ Kubelet çš„æ“ä½œã€‚</p>
<p>æ”¯æŒæŒ‰éœ€å’Œä¸ Kubernetes è¿‘ä¹å³æ—¶çš„ç¼–æ’å®¹å™¨è®¡ç®—ï¼Œæ— éœ€ç®¡ç† VM åŸºç¡€è®¾æ–½ï¼ŒåŒæ—¶ä»ç„¶åˆ©ç”¨å¯ç§»æ¤çš„ Kubernetes APIã€‚</p>
<p>æ¯ä¸ª Provider å¯èƒ½æœ‰è‡ªå·±çš„é…ç½®æ–‡ä»¶å’Œæ‰€éœ€çš„ç¯å¢ƒå˜é‡ã€‚</p>
<p>Provider å¿…é¡»å…·å¤‡ä»¥ä¸‹åŠŸèƒ½æ‰èƒ½ä¸ Virtual Kubelet é›†æˆæ”¯æŒï¼š</p>
<ul>
<li><p>æä¾›å¿…è¦çš„åç«¯æœåŠ¡ï¼Œç”¨äºæ”¯æŒ Kubernetes çš„ Podã€å®¹å™¨å’Œæ”¯æŒèµ„æºçš„ç”Ÿå‘½å‘¨æœŸç®¡ç†</p>
</li>
<li><p>ç¬¦åˆ Virtual Kubelet çš„ API è§„èŒƒ</p>
</li>
<li><p>æ— æ³•è®¿é—® Kubernetes API æœåŠ¡å™¨ï¼Œå¹¶ä¸”å…·æœ‰å®šä¹‰æ˜ç¡®çš„å›è°ƒæœºåˆ¶æ¥è·å– Secret æˆ– ConfigMap ç­‰æ•°æ®</p>
</li>
</ul>
<p><em>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://pkg.go.dev/github.com/virtual-kubelet/virtual-kubelet#section-readme">virtual-kubelet godoc</a></em></p>
<h2 id="Admiralty-Multi-Cluster-Scheduler"><a href="#Admiralty-Multi-Cluster-Scheduler" class="headerlink" title="Admiralty Multi-Cluster Scheduler"></a>Admiralty Multi-Cluster Scheduler</h2><p>Admiralty Multi-Cluster Scheduler å°†ç‰¹å®šçš„ Pod è¿è¡Œåœ¨ Virtual Kubelet èŠ‚ç‚¹ä¸Šï¼Œä½œä¸ºâ€œä»£ç† Podâ€ï¼Œå¹¶åœ¨è¿œç¨‹é›†ç¾¤ï¼ˆå®é™…è¿è¡Œå®¹å™¨ï¼‰ä¸­åˆ›å»ºç›¸åº”çš„â€å§”æ‰˜ Podâ€ã€‚é€šè¿‡æ§åˆ¶å¾ªç¯æœºåˆ¶ï¼Œæ›´æ–°ä»£ç† Pod çš„ä¿¡æ¯ç”¨æ¥åæ˜ å§”æ‰˜ Pod çš„çŠ¶æ€ã€‚</p>
<p><em>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/admiraltyio/multicluster-scheduler">Admiralty Multi-Cluster Scheduler documentation</a></em></p>
<h2 id="Alibaba-Cloud-Elastic-Container-Instance-ECI"><a href="#Alibaba-Cloud-Elastic-Container-Instance-ECI" class="headerlink" title="Alibaba Cloud Elastic Container Instance (ECI)"></a>Alibaba Cloud Elastic Container Instance (<strong>ECI</strong>)</h2><p>é˜¿é‡Œäº‘ ECIï¼ˆå¼¹æ€§å®¹å™¨å®ä¾‹ï¼‰æ˜¯ä¸€ç§æ— éœ€ç®¡ç†æœåŠ¡å™¨æˆ–é›†ç¾¤å³å¯è¿è¡Œå®¹å™¨çš„æœåŠ¡ã€‚é˜¿é‡Œäº‘ ECI Provider æ˜¯è¿æ¥ K8så’Œ ECI æœåŠ¡ä¹‹é—´çš„æ¡¥æ¢ã€‚</p>
<p><em>å‚è€ƒï¼š <a target="_blank" rel="noopener" href="https://github.com/virtual-kubelet/alibabacloud-eci/blob/master/README.md">Alibaba Cloud ECI documentation</a></em></p>
<h2 id="Azure-Container-Instances-ACI"><a href="#Azure-Container-Instances-ACI" class="headerlink" title="Azure Container Instances (ACI)"></a>Azure Container Instances (<strong>ACI</strong>)</h2><p>Azure å®¹å™¨å®ä¾‹ Provider å…è®¸åœ¨åŒä¸€ä¸ª Kubernetes é›†ç¾¤ä¸­åŒæ—¶ä½¿ç”¨ VM ä¸Šçš„ Pod å’Œ Azure å®¹å™¨å®ä¾‹ã€‚</p>
<div align=center><img width="600" style="border: 0px" src="/gallery/virtual-kubelet/aci.png"></div>

<p><em>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/virtual-kubelet/azure-aci/blob/master/README.md">Azure Container Instances documentation</a></em></p>
<h2 id="AWS-Fargate"><a href="#AWS-Fargate" class="headerlink" title="AWS Fargate"></a>AWS Fargate</h2><p>AWS Fargate æ˜¯ä¸€ç§å…è®¸è¿è¡Œå®¹å™¨è€Œæ— éœ€ç®¡ç†æœåŠ¡å™¨æˆ–é›†ç¾¤çš„æŠ€æœ¯ã€‚</p>
<p>AWS Fargate æä¾›å•†å…è®¸å°† Pod éƒ¨ç½²åˆ° AWS Fargateã€‚åœ¨ AWS Fargate ä¸Šçš„ Pod å¯ä»¥è®¿é—®å…·æœ‰å­ç½‘ä¸­ä¸“ç”¨ ENI çš„ VPC ç½‘ç»œã€è¿æ¥åˆ°äº’è”ç½‘çš„å…¬å…± IP åœ°å€ã€è¿æ¥åˆ° Kubernetes é›†ç¾¤çš„ç§æœ‰ IP åœ°å€ã€å®‰å…¨ç»„ã€IAM è§’è‰²ã€CloudWatch Logs å’Œè®¸å¤šå…¶ä»– AWS æœåŠ¡ã€‚ Fargate ä¸Šçš„ Pod å¯ä»¥ä¸åŒä¸€ Kubernetes é›†ç¾¤ä¸­å¸¸è§„å·¥ä½œèŠ‚ç‚¹ä¸Šçš„ Pod å…±å­˜ã€‚</p>
<p><em>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/virtual-kubelet/aws-fargate">AWS Fargate documentation</a></em></p>
<h2 id="Elotl-Kip"><a href="#Elotl-Kip" class="headerlink" title="Elotl Kip"></a>Elotl Kip</h2><p>Kip æ˜¯ä¸€ä¸ªåœ¨äº‘å®ä¾‹ä¸­è¿è¡Œ Pod çš„æä¾›å•†ï¼Œå…è®¸ Kubernetes é›†ç¾¤é€æ˜åœ°å°†å·¥ä½œè´Ÿè½½æ‰©å±•åˆ°äº‘ä¸­ã€‚å½“ä¸€ä¸ª Pod è¢«è°ƒåº¦åˆ°è™šæ‹ŸèŠ‚ç‚¹ä¸Šæ—¶ï¼ŒKip ä¼šä¸º Pod çš„å·¥ä½œè´Ÿè½½å¯åŠ¨ä¸€ä¸ªå¤§å°åˆé€‚çš„äº‘å®ä¾‹ï¼Œå¹¶å°† Pod è°ƒåº¦åˆ°è¯¥å®ä¾‹ä¸Šã€‚å½“ Pod å®Œæˆè¿è¡Œæ—¶ï¼Œäº‘å®ä¾‹å°†ç»ˆæ­¢ã€‚</p>
<p>å½“å·¥ä½œè´Ÿè½½åœ¨ Kip ä¸Šè¿è¡Œæ—¶ï¼Œé›†ç¾¤å¤§å°è‡ªç„¶ä¼šéšç€é›†ç¾¤å·¥ä½œè´Ÿè½½è€Œæ‰©å±•ï¼ŒPod å½¼æ­¤é«˜åº¦éš”ç¦»ï¼Œå¹¶ä¸”ç”¨æˆ·æ— éœ€ç®¡ç†å·¥ä½œèŠ‚ç‚¹å¹¶å°† Pod æˆ˜ç•¥æ€§åœ°è°ƒåº¦åˆ°èŠ‚ç‚¹ä¸Šã€‚</p>
<p><em>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/elotl/kip">Elotl Kip documentation</a></em></p>
<h2 id="Kubernetes-Container-Runtime-Interface-CRI"><a href="#Kubernetes-Container-Runtime-Interface-CRI" class="headerlink" title="Kubernetes Container Runtime Interface (CRI)"></a>Kubernetes Container Runtime Interface (<strong>CRI</strong>)</h2><p>CRI Provider æ˜¯åŸºäº CRI çš„å®¹å™¨è¿è¡Œæ—¶ç®¡ç†çœŸå®çš„ Pod å’Œå®¹å™¨ã€‚</p>
<p>CRI Provider çš„ç›®çš„ä»…ç”¨äºæµ‹è¯•å’ŒåŸå‹ã€‚ä¸å¾—ç”¨äºä»»ä½•å…¶ä»–ç›®çš„ï¼</p>
<p>Virtual Kubelet é¡¹ç›®çš„é‡ç‚¹æ˜¯ä¸ºä¸ç¬¦åˆæ ‡å‡†èŠ‚ç‚¹æ¨¡å‹çš„å®¹å™¨è¿è¡Œæ—¶æä¾›æ¥å£ã€‚ è€Œ Kubelet ä»£ç åº“æ˜¯å…¨é¢çš„æ ‡å‡† CRI èŠ‚ç‚¹ä»£ç†ï¼Œå¹¶ä¸”æ­¤ Provider ä¸ä¼šå°è¯•é‡æ–°åˆ›å»ºå®ƒã€‚</p>
<p>è¿™ä¸ª Provider å®ç°æ˜¯ä¸€ä¸ªæœ€åŸºæœ¬çš„æœ€å°å®ç°ï¼Œå®ƒå¯ä»¥æ›´å®¹æ˜“åœ°é’ˆå¯¹çœŸå®çš„ Pod å’Œå®¹å™¨æµ‹è¯• Virtual Kubelet é¡¹ç›®çš„æ ¸å¿ƒåŠŸèƒ½ â€”â€” æ¢å¥è¯è¯´ï¼Œå®ƒæ¯” MockProvider æ›´å…¨é¢ã€‚</p>
<p><strong>å·²çŸ¥é™åˆ¶</strong></p>
<ul>
<li>CRI Provider å®ç°äº† Provider æ¥å£å…¨éƒ¨æ“ä½œï¼Œä¸»è¦æ˜¯ç®¡ç† Pod çš„ç”Ÿå‘½å‘¨æœŸã€è¿”å›æ—¥å¿—å’Œå…¶ä»–å†…å®¹</li>
<li>å…·å¤‡åˆ›å»º emptyDirã€configmap å’Œ secret volumes çš„èƒ½åŠ›ï¼Œä½†å¦‚æœå½“å‘ç”Ÿå˜åŒ–æ—¶ä¸ä¼šæ›´æ–°</li>
<li>ä¸æ”¯æŒä»»ä½•ç±»å‹çš„æŒä¹…å·</li>
<li>ä¼šåœ¨å¯åŠ¨æ—¶å°è¯•è¿è¡Œ kube-proxyï¼Œå¹¶ä¸”å¯ä»¥æˆåŠŸè¿è¡Œã€‚ä½†æ˜¯ï¼Œå½“å°† Virtual Kubelet è½¬æ¢ä¸ºæŠ½è±¡åœ°å¤„ç† Service å’Œè·¯ç”±çš„æ¨¡å‹æ—¶ï¼Œæ­¤åŠŸèƒ½å°†è¢«é‡æ„ä¸ºæµ‹è¯•è¯¥åŠŸèƒ½çš„ä¸€ç§æ–¹å¼</li>
<li>ç½‘ç»œç›®å‰æ˜¯éåŠŸèƒ½æ€§çš„</li>
</ul>
<h2 id="Huawei-Cloud-Container-Instance-CCI"><a href="#Huawei-Cloud-Container-Instance-CCI" class="headerlink" title="Huawei Cloud Container Instance (CCI)"></a>Huawei Cloud Container Instance (<strong>CCI</strong>)</h2><p>åä¸º CCI Virtual Kubelet Provider å°† CCI é¡¹ç›®é…ç½®æˆä»»ä½• Kubernetes é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ï¼Œä¾‹å¦‚åä¸º CCEï¼ˆäº‘å®¹å™¨å¼•æ“ï¼‰ã€‚CCE æ”¯æŒåŸç”Ÿ Kubernetes åº”ç”¨å’Œå·¥å…·ä½œä¸ºç§æœ‰é›†ç¾¤ï¼Œä¾¿äºè½»æ¾æ­å»ºå®¹å™¨è¿è¡Œç¯å¢ƒã€‚è¢«è°ƒåº¦åˆ° Virtual Kubelet Provider çš„ Pod å°†è¿è¡Œåœ¨ CCI ä¸­ï¼Œä¾¿äºæ›´å¥½çš„åˆ©ç”¨ CCI çš„é«˜æ€§èƒ½ã€‚</p>
<div align=center><img width="600" style="border: 0px" src="https://raw.githubusercontent.com/virtual-kubelet/huawei-cci/master/cci-provider.svg"></div>

<p><em>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/virtual-kubelet/huawei-cci/blob/master/README.md#readme">Huawei CCI documentation</a></em></p>
<h2 id="HashiCorp-Nomad"><a href="#HashiCorp-Nomad" class="headerlink" title="HashiCorp Nomad"></a>HashiCorp Nomad</h2><p>Virtual Kubelet çš„ HashiCorp Nomad Provider é€šè¿‡å°† Nomad é›†ç¾¤å…¬å¼€ä¸º Kubernetes ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°†Kubernetes é›†ç¾¤ä¸ Nomad é›†ç¾¤è¿æ¥èµ·æ¥ã€‚å€ŸåŠ© Providerï¼Œåœ¨ Kubernetes ä¸Šæ³¨å†Œçš„è™šæ‹Ÿ Nomad èŠ‚ç‚¹ä¸Šè°ƒåº¦çš„ Pod å°†ä½œä¸º Job åœ¨ Nomad å®¢æˆ·ç«¯ä¸Šè¿è¡Œï¼Œå°±åƒåœ¨ Kubernetes èŠ‚ç‚¹ä¸Šä¸€æ ·ã€‚</p>
<p><em>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/virtual-kubelet/nomad/blob/master/README.md">HashiCorp Nomad documentation</a></em></p>
<h2 id="Liqo"><a href="#Liqo" class="headerlink" title="Liqo"></a>Liqo</h2><p>Liqo ä¸º Virtual Kubelet å®ç°äº†ä¸€ä¸ª Providerï¼Œæ—¨åœ¨é€æ˜åœ°å°† Pod å’ŒæœåŠ¡å¸è½½åˆ°â€œå¯¹ç­‰â€Kubernetes è¿œç¨‹é›†ç¾¤ã€‚ Liqo èƒ½å¤Ÿå‘ç°é‚»å±…é›†ç¾¤ï¼ˆä½¿ç”¨ DNSã€mDNSï¼‰å¹¶ä¸å…¶â€œå¯¹ç­‰â€ï¼Œæˆ–è€…è¯´å»ºç«‹å…³ç³»ä»¥å…±äº«é›†ç¾¤çš„éƒ¨åˆ†èµ„æºã€‚å½“é›†ç¾¤å»ºç«‹å¯¹ç­‰è¿æ¥æ—¶ï¼Œä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ Liqo Virtual Kubelet å®ä¾‹ï¼Œé€šè¿‡æä¾›è¿œç¨‹é›†ç¾¤èµ„æºçš„æŠ½è±¡æ¥æ— ç¼æ‰©å±•é›†ç¾¤çš„å®¹é‡ã€‚è¯¥æä¾›å•†ä¸ Liqo ç½‘ç»œç»“æ„ç›¸ç»“åˆï¼Œé€šè¿‡å¯ç”¨ Pod åˆ° Pod æµé‡å’Œå¤šé›†ç¾¤ä¸œè¥¿å‘æœåŠ¡æ‰©å±•é›†ç¾¤ç½‘ç»œï¼Œæ”¯æŒä¸¤ä¸ªé›†ç¾¤ä¸Šçš„ç«¯ç‚¹ã€‚</p>
<p><em>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/liqotech/liqo/blob/master/README.md">Liqo documentation</a></em></p>
<h2 id="OpenStack-Zun"><a href="#OpenStack-Zun" class="headerlink" title="OpenStack Zun"></a>OpenStack Zun</h2><p>Virtual Kubelet çš„ OpenStack Zun Provider ç”¨äºå°† Kubernetes é›†ç¾¤ä¸ OpenStack é›†ç¾¤æ‰“é€šï¼Œä»è€Œå¯ä»¥åœ¨ OpenStack ä¸Šè¿è¡Œ Kubernetes çš„ Podã€‚å€ŸåŠ©å­ç½‘ä¸­çš„ Neutron ç«¯å£ï¼Œåœ¨ OpenStack ä¸Šçš„ Pod å¯ä»¥è®¿é—® OpenStack ç§Ÿæˆ·ç½‘ç»œï¼Œæ¯ä¸ª Pod éƒ½æœ‰ç§æœ‰ IP åœ°å€ï¼Œå¯ä»¥è¿æ¥åˆ°ç§Ÿæˆ·å†…çš„å…¶ä»– OpenStack èµ„æºï¼ˆä¾‹å¦‚ VMï¼‰ï¼Œä¹Ÿå¯ä»¥å€ŸåŠ©æµ®åŠ¨ IP åœ°å€è¿æ¥äº’è”ç½‘ï¼Œæˆ–è€…å°† Cinder å·ç»‘å®šç»™ Pod å®¹å™¨ä½¿ç”¨ã€‚</p>
<p><em>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/virtual-kubelet/openstack-zun/blob/master/README.md">OpenStack Zun documentation</a></em></p>
<h2 id="Tencent-Games-Tensile-Kube"><a href="#Tencent-Games-Tensile-Kube" class="headerlink" title="Tencent Games Tensile Kube"></a>Tencent Games Tensile Kube</h2><p>Tensile Kube Provider ç”±è…¾è®¯æ¸¸æˆæä¾›ï¼Œå¯å°† Kubernetes é›†ç¾¤ä¸å…¶ä»– Kubernetes é›†ç¾¤è¿æ¥èµ·æ¥ã€‚è¯¥ Provider èƒ½å¤Ÿå°† Kubernetes é›†ç¾¤è§„æ¨¡æ— é™æ‰©å±•ã€‚åº•å±‚é›†ç¾¤ä»¥è™šæ‹ŸèŠ‚ç‚¹çš„å½¢æ€æ³¨å†Œåˆ°ä¸Šå±‚é›†ç¾¤ä¸­ï¼Œå€ŸåŠ© Providerï¼Œè°ƒåº¦åœ¨è™šæ‹ŸèŠ‚ç‚¹ä¸Šçš„ Pod å°†åœ¨å…¶ä»– Kubernetes é›†ç¾¤çš„èŠ‚ç‚¹ä¸Šè¿è¡Œã€‚</p>
<h3 id="æ¶æ„è®¾è®¡"><a href="#æ¶æ„è®¾è®¡" class="headerlink" title="æ¶æ„è®¾è®¡"></a>æ¶æ„è®¾è®¡</h3><div align=center><img width="600" style="border: 0px" src="https://raw.githubusercontent.com/virtual-kubelet/tensile-kube/master/docs/tensile-kube.png"></div>

<ul>
<li><p>virtual-node</p>
<p>åŸºäº virtual-kubelet å®ç°çš„ Kubernetes Providerã€‚åœ¨ä¸Šå±‚é›†ç¾¤ä¸­åˆ›å»ºçš„ Pod å°†åŒæ­¥åˆ°åº•å±‚é›†ç¾¤ã€‚å¦‚æœ Pod ä¾èµ–äº ConfigMaps æˆ– Secretï¼Œé‚£ä¹ˆä¾èµ–å…³ç³»ä¹Ÿä¼šåœ¨é›†ç¾¤ä¸­åˆ›å»º</p>
</li>
<li><p>multi-cluster scheduler</p>
<p>åŸºäº K8s schedule framework å®ç°ã€‚å®ƒä¼šåœ¨è°ƒåº¦ Pod æ—¶æ ¹æ®æ‰€æœ‰åº•å±‚é›†ç¾¤çš„å®¹é‡ï¼Œå¹¶è°ƒç”¨ filter è¿‡æ»¤å™¨ã€‚å¦‚æœå¯ç”¨èŠ‚ç‚¹æ•°å¤§äºæˆ–ç­‰äº 1ï¼Œåˆ™ Pod å¯ä»¥è¢«è°ƒåº¦ã€‚å› æ­¤ï¼Œè¿™å¯èƒ½ä¼šæ¶ˆè€—æ›´å¤šèµ„æºï¼Œå› æ­¤æ·»åŠ äº†å¦ä¸€ä¸ªå®ç°ï¼ˆdeschedulerï¼‰</p>
</li>
<li><p>descheduler</p>
<p>descheduler æ˜¯åŸºäº K8s descheduler çš„äºŒæ¬¡ä¼˜åŒ–ï¼Œæ”¹å˜äº†ä¸€äº›é€»è¾‘ã€‚å®ƒä¼šé€šè¿‡æ³¨å…¥ä¸€äº› nodeAffinity é‡æ–°åˆ›å»ºä¸€äº›ä¸å¯è°ƒåº¦çš„ Podã€‚å¯ä»¥é€‰æ‹©éƒ¨ç½²ä¸Šå±‚é›†ç¾¤ä¸­çš„ multi-scheduler å’Œ descheduler ä¹‹ä¸€ï¼Œä¹Ÿå¯ä»¥åŒæ—¶é€‰æ‹©ä¸¤è€…</p>
<ul>
<li>å¤§è§„æ¨¡é›†ç¾¤ä¸å»ºè®®ä½¿ç”¨ multi-schedulerï¼Œå½“èŠ‚ç‚¹æ€»æ•°è¶…è¿‡ 10000 æ—¶ï¼Œdescheduler å¼€é”€ç›¸å¯¹æ›´å°</li>
<li>å½“é›†ç¾¤ä¸­çš„èŠ‚ç‚¹è¾ƒå°‘æ—¶ï¼Œmulti-scheduler æ•ˆæœä¼šæ›´å¥½ï¼Œä¾‹å¦‚æœ‰ 10 ä¸ªé›†ç¾¤ï¼Œæ¯ä¸ªé›†ç¾¤åªæœ‰ 100 ä¸ªèŠ‚ç‚¹</li>
</ul>
</li>
<li><p>webhook</p>
<p>Webhook æ˜¯åŸºäº K8s mutation webhook è®¾è®¡çš„ã€‚ç”¨äºè½¬æ¢ä¸€äº›å¯èƒ½å½±å“ä¸Šå±‚é›†ç¾¤ä¸­è°ƒåº¦ Podï¼ˆä¸åœ¨ kube-system ä¸­ï¼‰çš„å­—æ®µï¼Œä¾‹å¦‚ nodeSelectorã€nodeAffinity å’Œ tolerationsã€‚ä½†æ˜¯åªæœ‰æ ‡ç­¾ä¸º virtual-pod:true çš„ Pod æ‰ä¼šè¢«è½¬æ¢</p>
<p>å¼ºçƒˆå»ºè®® Pod è¿è¡Œåœ¨åº•å±‚é›†ç¾¤å¹¶æ·»åŠ æ ‡ç­¾ virtual-pod:trueï¼Œé™¤éé‚£äº› Pod å¿…é¡»éƒ¨ç½²åœ¨ä¸Šå±‚é›†ç¾¤çš„ kube-system ä¸­</p>
<ul>
<li>å¯¹äº K8s &lt; 1.16ï¼Œæ²¡æœ‰ label çš„ pod ä¸ä¼šè¢«è½¬æ¢ã€‚ä½†ä»ä¼šå‘é€è¯·æ±‚åˆ° webhook</li>
<li>å¯¹äº K8s &gt;&#x3D; 1.16ï¼Œå¯ä»¥ä½¿ç”¨ label selector ä¸ºä¸€äº›æŒ‡å®šçš„ pod å¯ç”¨ webhook</li>
<li>æ€»çš„æ¥è¯´ï¼Œæœ€åˆçš„æƒ³æ³•æ˜¯åªåœ¨åº•å±‚é›†ç¾¤ä¸­è¿è¡Œ Pod</li>
</ul>
</li>
</ul>
<h3 id="é™åˆ¶"><a href="#é™åˆ¶" class="headerlink" title="é™åˆ¶"></a>é™åˆ¶</h3><ul>
<li>å¦‚æœè¦ä½¿ç”¨ Serverï¼Œå¿…é¡»ä¿æŒ Pod é—´é€šä¿¡æ­£å¸¸ã€‚é›†ç¾¤ A ä¸­çš„ Pod A å¯ä»¥è¢«é›†ç¾¤ B ä¸­çš„ Pod B é€šè¿‡ ip è®¿é—®ã€‚default å‘½åç©ºé—´ä¸­çš„æœåŠ¡ Kubernetes å’Œ kube-system ä¸­çš„å…¶ä»–æœåŠ¡å°†åŒæ­¥åˆ°è¾ƒåº•å±‚çš„é›†ç¾¤</li>
<li>åœ¨ repo ä¸­å¼€å‘çš„ multi-scheduler å¯èƒ½ä¼šèŠ±è´¹æ›´å¤šèµ„æºï¼Œå› ä¸ºå®ƒä¼šåŒæ­¥æ‰€æœ‰è¾ƒåº•å±‚é›†ç¾¤ä¸­è°ƒåº¦ç¨‹åºéœ€è¦çš„æ‰€æœ‰å¯¹è±¡</li>
<li>descheduler ä¸èƒ½ç»å¯¹é¿å…èµ„æºç¢ç‰‡åŒ–</li>
<li>PV&#x2F;PVC åªæ”¯æŒæœ¬åœ° PV çš„ WaitForFirstConsumerï¼Œä¸Šå±‚é›†ç¾¤çš„è°ƒåº¦å™¨åº”è¯¥å¿½ç•¥ VolumeBindCheck</li>
</ul>
<h3 id="ç”¨ä¾‹"><a href="#ç”¨ä¾‹" class="headerlink" title="ç”¨ä¾‹"></a>ç”¨ä¾‹</h3><div align=center><img width="800" style="border: 0px" src="https://raw.githubusercontent.com/virtual-kubelet/tensile-kube/master/docs/multi.png"></div>

<p><em>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/virtual-kubelet/tensile-kube/blob/master/README.md">Tensile Kube documentation</a></em></p>
<h1 id="Provider-æ¥å£å®ç°"><a href="#Provider-æ¥å£å®ç°" class="headerlink" title="Provider æ¥å£å®ç°"></a>Provider æ¥å£å®ç°</h1><p>Provider å®ç°äº† Kubernetes èŠ‚ç‚¹ä»£ç† ï¼ˆå³ Kubeletï¼‰çš„æ ¸å¿ƒé€»è¾‘ã€‚</p>
<h2 id="PodLifecylceHandler"><a href="#PodLifecylceHandler" class="headerlink" title="PodLifecylceHandler"></a>PodLifecylceHandler</h2><p>ç”¨äºå¤„ç†åœ¨ Kubernetes ä¸­åˆ›å»ºã€æ›´æ–°æˆ–åˆ é™¤ Pod çš„è¯·æ±‚ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://godoc.org/github.com/virtual-kubelet/virtual-kubelet/node#PodLifecycleHandler">godoc#PodLifecylceHandler</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> PodLifecycleHandler <span class="keyword">interface</span> &#123;</span><br><span class="line">    <span class="comment">// CreatePod takes a Kubernetes Pod and deploys it within the provider.</span></span><br><span class="line">    CreatePod(ctx context.Context, pod *corev1.Pod) <span class="type">error</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// UpdatePod takes a Kubernetes Pod and updates it within the provider.</span></span><br><span class="line">    UpdatePod(ctx context.Context, pod *corev1.Pod) <span class="type">error</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// DeletePod takes a Kubernetes Pod and deletes it from the provider.</span></span><br><span class="line">    DeletePod(ctx context.Context, pod *corev1.Pod) <span class="type">error</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// GetPod retrieves a pod by name from the provider (can be cached).</span></span><br><span class="line">    GetPod(ctx context.Context, namespace, name <span class="type">string</span>) (*corev1.Pod, <span class="type">error</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// GetPodStatus retrieves the status of a pod by name from the provider.</span></span><br><span class="line">    GetPodStatus(ctx context.Context, namespace, name <span class="type">string</span>) (*corev1.PodStatus, <span class="type">error</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// GetPods retrieves a list of all pods running on the provider (can be cached).</span></span><br><span class="line">    GetPods(context.Context) ([]*corev1.Pod, <span class="type">error</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿˜æœ‰ä¸€ä¸ªå¯é€‰å®ç°çš„æ¥å£ PodNotifieryï¼Œç”¨äº Provider å¼‚æ­¥é€šçŸ¥ virtual-kubelet æœ‰å…³ Pod çŠ¶æ€æ›´æ”¹çš„ä¿¡æ¯ã€‚å¦‚æœæ²¡æœ‰å®ç°è¿™ä¸ªæ¥å£ï¼Œvirtual-kubelet ä¼šå‘¨æœŸæ€§çš„æ£€æŸ¥æ‰€æœ‰ Pod çš„çŠ¶æ€ã€‚</p>
<p><em>å¼ºçƒˆå»ºè®®å®ç° PodNotifierï¼Œå°¤å…¶æ˜¯å½“è¿è¡Œå¤§é‡ Pod æ—¶ã€‚</em></p>
<p><a target="_blank" rel="noopener" href="https://godoc.org/github.com/virtual-kubelet/virtual-kubelet/node#PodNotifier">godoc#PodNotifier</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> PodNotifier <span class="keyword">interface</span> &#123;</span><br><span class="line">    <span class="comment">// NotifyPods instructs the notifier to call the passed in function when</span></span><br><span class="line">    <span class="comment">// the pod status changes.</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// NotifyPods should not block callers.</span></span><br><span class="line">    NotifyPods(context.Context, <span class="function"><span class="keyword">func</span><span class="params">(*corev1.Pod)</span></span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>PodLifecycleHandler ç”± PodController ç»´æŠ¤ï¼ŒPodController æ˜¯ç®¡ç†åˆ†é…ç»™èŠ‚ç‚¹ Pod çš„æ ¸å¿ƒé€»è¾‘ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pc, _ := node.NewPodController(podControllerConfig) <span class="comment">// &lt;-- instatiates the pod controller</span></span><br><span class="line">pc.Run(ctx) <span class="comment">// &lt;-- starts watching for pods to be scheduled on the node</span></span><br></pre></td></tr></table></figure>

<h2 id="NodeProvider"><a href="#NodeProvider" class="headerlink" title="NodeProvider"></a>NodeProvider</h2><p>NodeProvider è´Ÿè´£é€šçŸ¥ virtual-kubelet èŠ‚ç‚¹çŠ¶æ€æ›´æ–°ã€‚ virtual-kubelet ä¼šå®šæœŸæ£€æŸ¥èŠ‚ç‚¹çš„çŠ¶æ€å¹¶ç›¸åº”åœ°æ›´æ–°è‡³ Kubernetesã€‚</p>
<p><a target="_blank" rel="noopener" href="https://godoc.org/github.com/virtual-kubelet/virtual-kubelet/node#NodeProvider">godoc#NodeProvider</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> NodeProvider <span class="keyword">interface</span> &#123;</span><br><span class="line">    <span class="comment">// Ping checks if the node is still active.</span></span><br><span class="line">    <span class="comment">// This is intended to be lightweight as it will be called periodically as a</span></span><br><span class="line">    <span class="comment">// heartbeat to keep the node marked as ready in Kubernetes.</span></span><br><span class="line">    Ping(context.Context) <span class="type">error</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// NotifyNodeStatus is used to asynchronously monitor the node.</span></span><br><span class="line">    <span class="comment">// The passed in callback should be called any time there is a change to the</span></span><br><span class="line">    <span class="comment">// node&#x27;s status.</span></span><br><span class="line">    <span class="comment">// This will generally trigger a call to the Kubernetes API server to update</span></span><br><span class="line">    <span class="comment">// the status.</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// NotifyNodeStatus should not block callers.</span></span><br><span class="line">    NotifyNodeStatus(ctx context.Context, cb <span class="function"><span class="keyword">func</span><span class="params">(*corev1.Node)</span></span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>NodeProvider ç”± NodeController ç»´æŠ¤ï¼Œè¿™æ˜¯ Kubernetes ç®¡ç†èŠ‚ç‚¹å¯¹è±¡çš„æ ¸å¿ƒé€»è¾‘ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nc, _ := node.NewNodeController(nodeProvider, nodeSpec) <span class="comment">// &lt;-- instantiate a node controller from a node provider and a kubernetes node spec</span></span><br><span class="line">nc.Run(ctx) <span class="comment">// &lt;-- creates the node in kubernetes and starts up he controller</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://godoc.org/github.com/virtual-kubelet/virtual-kubelet/node#NaiveNodeProvider">godoc#NaiveNodeProvider</a></p>
<p>Virtual Kubelet æä¾›äº†ä¸€ä¸ª NaiveNodeProviderï¼Œç”¨äºä¸æ‰“ç®—è‡ªå®šä¹‰èŠ‚ç‚¹è¡Œä¸ºæ—¶ã€‚</p>
<h2 id="API-endpoints"><a href="#API-endpoints" class="headerlink" title="API endpoints"></a>API endpoints</h2><p>Kubelet çš„å·¥ä½œä¹‹ä¸€æ˜¯æ¥å—æ¥è‡ª API Server çš„è¯·æ±‚ï¼Œæ¯”å¦‚ kubectl logs å’Œ kubectl execã€‚</p>
<p>å¦‚æœæƒ³åœ¨é›†ç¾¤ä¸­ä½¿ç”¨ HPAï¼ˆHorizontal Pod Autoscalerï¼‰ï¼ŒProvider åº”è¯¥å®ç° GetStatsSummary å‡½æ•°ã€‚ç„¶å metrics-server å°†èƒ½å¤Ÿè·å– virtual-kubelet ä¸Šçš„ Pod çš„æŒ‡æ ‡ã€‚å¦åˆ™ï¼Œå¯èƒ½ä¼šåœ¨ metrics-server ä¸Šçœ‹åˆ° No metrics for podï¼Œè¿™æ„å‘³ç€ä¸ä¼šæ”¶é›† virtual-kubelet ä¸Šçš„ Pod çš„æŒ‡æ ‡ã€‚</p>
<h1 id="å·²çŸ¥é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ"><a href="#å·²çŸ¥é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ" class="headerlink" title="å·²çŸ¥é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ"></a>å·²çŸ¥é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ</h1><h2 id="Service-ç¼ºå°‘-Load-Balancer-IP"><a href="#Service-ç¼ºå°‘-Load-Balancer-IP" class="headerlink" title="Service ç¼ºå°‘ Load Balancer IP"></a>Service ç¼ºå°‘ Load Balancer IP</h2><p><strong>Provider ä¸æ”¯æŒæœåŠ¡å‘ç°</strong></p>
<p>Kubernetes 1.9 ä¸ºæ§åˆ¶å¹³é¢çš„ Controller Manager å¼•å…¥äº†ä¸€ä¸ªæ–°æ ‡è¯† ServiceNodeExclusionã€‚åœ¨ Controller Manager çš„é…ç½®æ–‡ä»¶ä¸­å¯ç”¨æ­¤æ ‡å¿—å…è®¸ Kubernetes å°† Virtual Kubelet èŠ‚ç‚¹æ’é™¤åœ¨æ·»åŠ åˆ°è´Ÿè½½å‡è¡¡å™¨æ± ä¹‹å¤–ï¼Œåˆ›å»ºå…·æœ‰å¤–éƒ¨ IP çš„ Serviceã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>
<p>é›†ç¾¤è¦æ±‚ï¼šKubernetes 1.9æˆ–ä»¥ä¸Š</p>
<p>Controller Manager é…ç½®æ–‡ä»¶ä¸­æ–°å¢ â€“feature-gates&#x3D;ServiceNodeExclusion&#x3D;true å‚æ•°å¯ç”¨ ServiceNodeExclusion æ ‡è¯†ã€‚</p>
<h1 id="å®è·µæ“ä½œ"><a href="#å®è·µæ“ä½œ" class="headerlink" title="å®è·µæ“ä½œ"></a>å®è·µæ“ä½œ</h1><p>ä»¥ Tensile Kube Provider ä¸ºä¾‹ã€‚</p>
<p><strong>å‡†å¤‡å·¥ä½œ</strong></p>
<p>Tensile Kube Provider æ˜¯å°†å…¶ä»–çš„ Kubernetes é›†ç¾¤ä»¥è™šæ‹ŸèŠ‚ç‚¹çš„å½¢å¼åŠ å…¥åˆ°ä¸»é›†ç¾¤ï¼Œå› æ­¤éœ€è¦å‡†å¤‡ä¸¤ä¸ªé›†ç¾¤ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸Šå±‚é›†ç¾¤</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl get node</span></span><br><span class="line">NAME           STATUS   ROLES                  AGE   VERSION</span><br><span class="line">desktop-ca83   Ready    control-plane,master   16d   v1.22.9</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åº•å±‚é›†ç¾¤</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl get node</span></span><br><span class="line">NAME              STATUS   ROLES    AGE    VERSION</span><br><span class="line">archcnstcm67370   Ready    master   2d5h   v1.18.15</span><br><span class="line">archcnstcm67371   Ready    master   2d5h   v1.18.15</span><br><span class="line">archcnstcm67372   Ready    master   2d5h   v1.18.15</span><br></pre></td></tr></table></figure>

<p><strong>ç¼–è¯‘ virtual-node</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">clone</span> https://github.com/virtual-kubelet/tensile-kube.git</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> tensile-kube &amp;&amp; make</span></span><br></pre></td></tr></table></figure>

<p><strong>Provider éƒ¨ç½²</strong></p>
<p>Tensile Kube Provider è¿è¡Œåœ¨åº•å±‚é›†ç¾¤ä¸­ï¼Œå°†å…¶ä¸‰èŠ‚ç‚¹é›†ç¾¤ä»¥è™šæ‹ŸèŠ‚ç‚¹ vk-node åŠ å…¥åˆ°ä¸Šå±‚é›†ç¾¤ä¸­ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åº•å±‚é›†ç¾¤å¯åŠ¨ Tensile Kube Providerï¼Œå…¶ä¸­ kubeconfig ä¸ºä¸Šå±‚é›†ç¾¤çš„é…ç½®æ–‡ä»¶ï¼Œclient-kubeconfig ä¸ºåº•å±‚é›†ç¾¤çš„é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./virtual-node --nodename vk-node --kubeconfig ./config --client-kubeconfig /root/.kube/config</span></span><br><span class="line">I1124 16:47:19.501216 3727733 provider.go:158] Informer started</span><br><span class="line">I1124 16:47:19.902257 3727733 service_controller.go:114] Starting controller</span><br><span class="line">I1124 16:47:19.902298 3727733 common_controller.go:115] Starting controller</span><br><span class="line">I1124 16:47:19.902331 3727733 pv_controller.go:129] Starting controller</span><br><span class="line">ERRO[0000] TLS certificates not provided, not setting up pod http server  caPath= certPath= keyPath= node=vk-node operatingSystem=Linux provider=k8s watchedNamespace=</span><br><span class="line">INFO[0000] Initialized                                   node=vk-node operatingSystem=Linux provider=k8s watchedNamespace=</span><br><span class="line">I1124 16:47:19.902447 3727733 node.go:98] Called NotifyNodeStatus</span><br><span class="line">I1124 16:47:19.902455 3727733 pod.go:321] Called NotifyPods</span><br><span class="line">INFO[0000] Pod cache in-sync                             node=vk-node operatingSystem=Linux provider=k8s watchedNamespace=</span><br><span class="line">INFO[0000] starting workers                              node=vk-node operatingSystem=Linux provider=k8s watchedNamespace=</span><br><span class="line">INFO[0000] started workers                               node=vk-node operatingSystem=Linux provider=k8s watchedNamespace=</span><br><span class="line">I1124 16:47:20.607794 3727733 service_controller.go:144] enqueue service addkey istio-system/istio-ingressgateway</span><br><span class="line">I1124 16:47:20.607839 3727733 service_controller.go:144] enqueue service addkey istio-system/istiod</span><br><span class="line">I1124 16:47:20.607855 3727733 service_controller.go:144] enqueue service addkey velero/minio</span><br><span class="line">I1124 16:47:20.607803 3727733 service_controller.go:176] enqueue endpoint add key velero/minio</span><br><span class="line">I1124 16:47:20.607878 3727733 service_controller.go:176] enqueue endpoint add key istio-system/istio-ingressgateway</span><br><span class="line">I1124 16:47:20.607887 3727733 service_controller.go:176] enqueue endpoint add key istio-system/istiod</span><br><span class="line">I1124 16:47:20.702816 3727733 pv_controller.go:135] Sync caches from master successfully</span><br><span class="line">I1124 16:47:20.702859 3727733 pv_controller.go:140] Sync caches from client successfully</span><br><span class="line">I1124 16:47:20.702816 3727733 service_controller.go:120] Sync caches from master successfully</span><br><span class="line">I1124 16:47:20.702903 3727733 service_controller.go:125] Sync caches from client successfully</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸Šå±‚é›†ç¾¤</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl get node</span></span><br><span class="line">NAME           STATUS   ROLES                  AGE   VERSION</span><br><span class="line">desktop-ca83   Ready    control-plane,master   16d   v1.22.9</span><br><span class="line">vk-node        Ready    agent                  9s    v1.18.15</span><br></pre></td></tr></table></figure>

<p>Provider å¯ä»¥éƒ¨ç½²åœ¨ä»»æ„é›†ç¾¤ä¸­ï¼Œé€šè¿‡ â€“kubeconfig å’Œ â€“client-kubeconfig æŒ‡å®šä¸Šå±‚åº•å±‚é›†ç¾¤å³å¯ï¼Œä¹Ÿå¯ä»¥ç»„æˆç½‘çŠ¶é›†ç¾¤æˆ–è€…å…¬ç”¨è™šæ‹ŸèŠ‚ç‚¹çš„é›†ç¾¤ã€‚</p>
<p><strong>è°ƒåº¦</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸Šå±‚é›†ç¾¤éƒ¨ç½²çš„è´Ÿè½½ä¿¡æ¯</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ConfigMap</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">myconfigmap</span></span><br><span class="line"><span class="attr">data:</span></span><br><span class="line">  <span class="attr">username:</span> <span class="string">vk-demo</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Secret</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">mysecret</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">Opaque</span></span><br><span class="line"><span class="attr">data:</span></span><br><span class="line">  <span class="attr">USER_NAME:</span> <span class="string">YWRtaW4=</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolume</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">vk-demo</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">capacity:</span></span><br><span class="line">    <span class="attr">storage:</span> <span class="string">100Gi</span></span><br><span class="line">  <span class="attr">volumeMode:</span> <span class="string">Filesystem</span></span><br><span class="line">  <span class="attr">accessModes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">ReadWriteOnce</span></span><br><span class="line">  <span class="attr">persistentVolumeReclaimPolicy:</span> <span class="string">Retain</span></span><br><span class="line">  <span class="attr">storageClassName:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="attr">local:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">/tmp/example</span></span><br><span class="line">  <span class="attr">nodeAffinity:</span></span><br><span class="line">    <span class="attr">required:</span></span><br><span class="line">      <span class="attr">nodeSelectorTerms:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">matchExpressions:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">kubernetes.io/hostname</span></span><br><span class="line">          <span class="attr">operator:</span> <span class="string">In</span></span><br><span class="line">          <span class="attr">values:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">vk-node</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolumeClaim</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">vk-demo</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="comment"># Optional:</span></span><br><span class="line">  <span class="comment"># storageClassName: &lt;YOUR_STORAGE_CLASS_NAME&gt;</span></span><br><span class="line">  <span class="attr">storageClassName:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="attr">accessModes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ReadWriteOnce</span></span><br><span class="line">  <span class="attr">resources:</span></span><br><span class="line">    <span class="attr">requests:</span></span><br><span class="line">      <span class="attr">storage:</span> <span class="string">50Mi</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">vk-demo</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">automountServiceAccountToken:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">busybox</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">busybox:1.27</span></span><br><span class="line">    <span class="attr">imagePullPolicy:</span> <span class="string">IfNotPresent</span></span><br><span class="line">    <span class="attr">command:</span> [<span class="string">&quot;/bin/sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;tail -f /dev/null&quot;</span>]</span><br><span class="line">    <span class="attr">volumeMounts:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">foo</span></span><br><span class="line">      <span class="attr">mountPath:</span> <span class="string">&quot;/etc/foo&quot;</span></span><br><span class="line">      <span class="attr">readOnly:</span> <span class="literal">true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">bar</span></span><br><span class="line">      <span class="attr">mountPath:</span> <span class="string">&quot;/etc/bar&quot;</span></span><br><span class="line">      <span class="attr">readOnly:</span> <span class="literal">true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/datadir</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">local</span></span><br><span class="line">  <span class="attr">nodeSelector:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">virtual-kubelet</span></span><br><span class="line">  <span class="attr">tolerations:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">&quot;virtual-kubelet.io/provider&quot;</span></span><br><span class="line">    <span class="attr">operator:</span> <span class="string">&quot;Exists&quot;</span></span><br><span class="line">    <span class="attr">effect:</span> <span class="string">&quot;NoSchedule&quot;</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">foo</span></span><br><span class="line">    <span class="attr">configMap:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">myconfigmap</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">bar</span></span><br><span class="line">    <span class="attr">secret:</span></span><br><span class="line">      <span class="attr">secretName:</span> <span class="string">mysecret</span></span><br><span class="line">      <span class="attr">optional:</span> <span class="literal">false</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">local</span></span><br><span class="line">    <span class="attr">persistentVolumeClaim:</span></span><br><span class="line">      <span class="attr">claimName:</span> <span class="string">vk-demo</span></span><br></pre></td></tr></table></figure>

<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åº•å±‚é›†ç¾¤é¢„å…ˆå‡†å¤‡å¯ç”¨çš„å·</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolume</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">vk-demo</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">capacity:</span></span><br><span class="line">    <span class="attr">storage:</span> <span class="string">100Gi</span></span><br><span class="line">  <span class="attr">volumeMode:</span> <span class="string">Filesystem</span></span><br><span class="line">  <span class="attr">accessModes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">ReadWriteOnce</span></span><br><span class="line">  <span class="attr">persistentVolumeReclaimPolicy:</span> <span class="string">Retain</span></span><br><span class="line">  <span class="attr">storageClassName:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="attr">local:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">/tmp/example</span></span><br><span class="line">  <span class="attr">nodeAffinity:</span></span><br><span class="line">    <span class="attr">required:</span></span><br><span class="line">      <span class="attr">nodeSelectorTerms:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">matchExpressions:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">kubernetes.io/hostname</span></span><br><span class="line">          <span class="attr">operator:</span> <span class="string">In</span></span><br><span class="line">          <span class="attr">values:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">archcnstcm67370</span></span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºè´Ÿè½½ä¹‹åå¯ä»¥çœ‹åˆ°ï¼ŒåŸæœ¬åœ¨ä¸Šå±‚çš„ configmapã€secret å’Œ pvcï¼Œé€ä¼ åˆ°å¯¹åº”çš„åº•å±‚é›†ç¾¤åˆ›å»ºäº†ä¸€ä»½</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åº•å±‚é›†ç¾¤</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl get configmap</span></span><br><span class="line">NAME          DATA   AGE</span><br><span class="line">myconfigmap   1      15m</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl get secret</span></span><br><span class="line">NAME                  TYPE                                  DATA   AGE</span><br><span class="line">default-token-jxhcg   kubernetes.io/service-account-token   3      2d7h</span><br><span class="line">mysecret              Opaque                                1      15m</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl get pvc</span></span><br><span class="line">NAME                 STATUS   VOLUME   CAPACITY   ACCESS MODES   STORAGECLASS             AGE</span><br><span class="line">vk-demo              Bound    vk-demo  100Gi      RWO                                     16m</span><br></pre></td></tr></table></figure>

<p>è´Ÿè½½åœ¨ä¸Šå±‚é›†ç¾¤å’Œåº•å±‚é›†ç¾¤å‡å¯ä»¥æŸ¥è¯¢åˆ°ï¼Œä½†ç”±äºä¸¤ä¸ªé›†ç¾¤ Pod ç½‘ç»œæœªæ‰“é€šï¼Œå› æ­¤æ— æ³•é€šè¿‡ä¸Šå±‚é›†ç¾¤ exec æˆ–è€… log æŸ¥çœ‹</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">I1124 17:52:59.931178 2460220 helper.go:57] pod vk-demo depends on secrets [mysecret]</span><br><span class="line">I1124 17:52:59.931202 2460220 helper.go:70] pod vk-demo depends on configMap [myconfigmap]</span><br><span class="line">I1124 17:52:59.931210 2460220 helper.go:83] pod vk-demo depends on pvc [vk-demo]</span><br><span class="line">I1124 17:52:59.936998 2460220 pod.go:457] Create myconfigmap in default success</span><br><span class="line">I1124 17:52:59.937019 2460220 pod.go:79] Create configmaps [myconfigmap] of default/vk-demo success</span><br><span class="line">INFO[0028] Created pod in provider                      </span><br><span class="line">INFO[0028] Event(v1.ObjectReference&#123;Kind:&quot;Pod&quot;, Namespace:&quot;default&quot;, Name:&quot;vk-demo&quot;, UID:&quot;1c52b390-29ab-40de-b892-860db9fe3418&quot;, APIVersion:&quot;v1&quot;, ResourceVersion:&quot;3395567&quot;, FieldPath:&quot;&quot;&#125;): type: &#x27;Normal&#x27; reason: &#x27;ProviderCreateSuccess&#x27; Create pod in provider successfully  node=vk-node operatingSystem=Linux provider=k8s watchedNamespace=</span><br><span class="line">I1124 17:53:00.023488 2460220 pod.go:84] Create pvc [vk-demo] of default/vk-demo success</span><br><span class="line">INFO[0029] Updated pod in provider                      </span><br><span class="line">INFO[0029] Event(v1.ObjectReference&#123;Kind:&quot;Pod&quot;, Namespace:&quot;default&quot;, Name:&quot;vk-demo&quot;, UID:&quot;1c52b390-29ab-40de-b892-860db9fe3418&quot;, APIVersion:&quot;v1&quot;, ResourceVersion:&quot;3395570&quot;, FieldPath:&quot;&quot;&#125;): type: &#x27;Normal&#x27; reason: &#x27;ProviderUpdateSuccess&#x27; Update pod in provider successfully  node=vk-node operatingSystem=Linux provider=k8s watchedNamespace=</span><br><span class="line">INFO[0042] Updated pod in provider                      </span><br><span class="line">INFO[0042] Event(v1.ObjectReference&#123;Kind:&quot;Pod&quot;, Namespace:&quot;default&quot;, Name:&quot;vk-demo&quot;, UID:&quot;1c52b390-29ab-40de-b892-860db9fe3418&quot;, APIVersion:&quot;v1&quot;, ResourceVersion:&quot;3395617&quot;, FieldPath:&quot;&quot;&#125;): type: &#x27;Normal&#x27; reason: &#x27;ProviderUpdateSuccess&#x27; Update pod in provider successfully  node=vk-node operatingSystem=Linux provider=k8s watchedNamespace=</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl get pod -o wide</span></span><br><span class="line">NAME      READY   STATUS    RESTARTS   AGE   IP           NODE      NOMINATED NODE   READINESS GATES</span><br><span class="line">vk-demo   1/1     Running   0          16m   10.244.0.1   vk-node   &lt;none&gt;           &lt;none&gt;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl get pod -o wide</span></span><br><span class="line">NAME      READY   STATUS    RESTARTS   AGE   IP            NODE              NOMINATED NODE   READINESS GATES</span><br><span class="line">vk-demo   1/1     Running   0          17m   10.244.0.1    archcnstcm67370   &lt;none&gt;           &lt;none&gt;</span><br></pre></td></tr></table></figure>

<p><strong>æ€»ç»“</strong></p>
<p>Tensile Kube Provider</p>
<ul>
<li>åº•å±‚å¤šèŠ‚ç‚¹é›†ç¾¤æ˜¯ä»¥ä¸€ä¸ªå•ç‹¬çš„è™šæ‹ŸèŠ‚ç‚¹åŠ å…¥çš„ä¸Šå±‚é›†ç¾¤ä¸­</li>
<li>åœ¨ä¸Šå±‚é›†ç¾¤åˆ›å»ºçš„è´Ÿè½½ï¼Œä¼šé€šè¿‡ virtual-node ç»„ä»¶ä¸‹å‘åˆ°åº•å±‚é›†ç¾¤å¯¹åº”çš„ api-server ä¸­ï¼ˆå¯ä»¥æ”¯æŒ HAï¼‰ï¼Œä¼šæ ¹æ®åº•å±‚é›†ç¾¤çš„æƒ…å†µè¿›è¡Œå®é™…è°ƒåº¦</li>
<li>ç”±äºå·¥ä½œè´Ÿè½½çœŸå®è¿è¡Œåœ¨åº•å±‚é›†ç¾¤ä¸­ï¼Œå…¶ä¾èµ–çš„ Secretã€Configmap å’Œ PVC ç­‰èµ„æºåŒæ ·çš„ä¼šé€ä¼ ç»™åº•å±‚é›†ç¾¤åˆ›å»ºï¼Œå…¶è¿è¡Œæ—¶çš„èµ„æºç”±åº•å±‚é›†ç¾¤åˆ†é…å¹¶ç»´æŠ¤ï¼Œä¾‹å¦‚ Pod çš„ç½‘ç»œã€å­˜å‚¨ç­‰</li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>ã€Œ Virtual Kubelet ã€Virtual Kubelet æ¦‚è¿°</p><p><a href="http://shenxianghong.github.io/2022/11/22/2022-11-22 Virtual Kubelet æ¦‚è¿°/">http://shenxianghong.github.io/2022/11/22/2022-11-22 Virtual Kubelet æ¦‚è¿°/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Shen Xianghong</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2022-11-22</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2023-05-04</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i>Â <a class="link-muted" rel="tag" href="/tags/Virtual-Kubelet/">Virtual Kubelet </a></div></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2022/11/26/2022-11-26%20Kata%20Containers%20%E6%BA%90%E7%A0%81%E8%B5%B0%E8%AF%BB%20-%20kata-runtime/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">ã€Œ Kata Containers ã€æºç èµ°è¯» â€” kata-runtime</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2022/11/14/2022-11-14%20Kata%20Containers%20%E6%9E%B6%E6%9E%84%E6%BC%94%E8%BF%9B/"><span class="level-item">ã€Œ Kata Containers ã€æ¶æ„æ¼”è¿›</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://avatars.githubusercontent.com/u/35031258?v=4" alt="ğŸ¾Corgi"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">ğŸ¾Corgi</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">50</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">7</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">9</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/shenxianghong" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Youtube" href="https://youtube.com"><i class="fab fa-youtube"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Bilibili" href="https://bilibili.com"><i class="fab fa-bilibili"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Reddit" href="https://reddit.com"><i class="fab fa-reddit"></i></a></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://google.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Google</span></span><span class="level-right"><span class="level-item tag">google.com</span></span></a></li><li><a class="level is-mobile" href="https://freegpt.one" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">ChatGPT</span></span><span class="level-right"><span class="level-item tag">freegpt.one</span></span></a></li></ul></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#ç®€ä»‹"><span class="level-left"><span class="level-item">1</span><span class="level-item">ç®€ä»‹</span></span></a></li><li><a class="level is-mobile" href="#æ¶æ„"><span class="level-left"><span class="level-item">2</span><span class="level-item">æ¶æ„</span></span></a></li><li><a class="level is-mobile" href="#Providers"><span class="level-left"><span class="level-item">3</span><span class="level-item">Providers</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Admiralty-Multi-Cluster-Scheduler"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">Admiralty Multi-Cluster Scheduler</span></span></a></li><li><a class="level is-mobile" href="#Alibaba-Cloud-Elastic-Container-Instance-ECI"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">Alibaba Cloud Elastic Container Instance (ECI)</span></span></a></li><li><a class="level is-mobile" href="#Azure-Container-Instances-ACI"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">Azure Container Instances (ACI)</span></span></a></li><li><a class="level is-mobile" href="#AWS-Fargate"><span class="level-left"><span class="level-item">3.4</span><span class="level-item">AWS Fargate</span></span></a></li><li><a class="level is-mobile" href="#Elotl-Kip"><span class="level-left"><span class="level-item">3.5</span><span class="level-item">Elotl Kip</span></span></a></li><li><a class="level is-mobile" href="#Kubernetes-Container-Runtime-Interface-CRI"><span class="level-left"><span class="level-item">3.6</span><span class="level-item">Kubernetes Container Runtime Interface (CRI)</span></span></a></li><li><a class="level is-mobile" href="#Huawei-Cloud-Container-Instance-CCI"><span class="level-left"><span class="level-item">3.7</span><span class="level-item">Huawei Cloud Container Instance (CCI)</span></span></a></li><li><a class="level is-mobile" href="#HashiCorp-Nomad"><span class="level-left"><span class="level-item">3.8</span><span class="level-item">HashiCorp Nomad</span></span></a></li><li><a class="level is-mobile" href="#Liqo"><span class="level-left"><span class="level-item">3.9</span><span class="level-item">Liqo</span></span></a></li><li><a class="level is-mobile" href="#OpenStack-Zun"><span class="level-left"><span class="level-item">3.10</span><span class="level-item">OpenStack Zun</span></span></a></li><li><a class="level is-mobile" href="#Tencent-Games-Tensile-Kube"><span class="level-left"><span class="level-item">3.11</span><span class="level-item">Tencent Games Tensile Kube</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#æ¶æ„è®¾è®¡"><span class="level-left"><span class="level-item">3.11.1</span><span class="level-item">æ¶æ„è®¾è®¡</span></span></a></li><li><a class="level is-mobile" href="#é™åˆ¶"><span class="level-left"><span class="level-item">3.11.2</span><span class="level-item">é™åˆ¶</span></span></a></li><li><a class="level is-mobile" href="#ç”¨ä¾‹"><span class="level-left"><span class="level-item">3.11.3</span><span class="level-item">ç”¨ä¾‹</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#Provider-æ¥å£å®ç°"><span class="level-left"><span class="level-item">4</span><span class="level-item">Provider æ¥å£å®ç°</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#PodLifecylceHandler"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">PodLifecylceHandler</span></span></a></li><li><a class="level is-mobile" href="#NodeProvider"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">NodeProvider</span></span></a></li><li><a class="level is-mobile" href="#API-endpoints"><span class="level-left"><span class="level-item">4.3</span><span class="level-item">API endpoints</span></span></a></li></ul></li><li><a class="level is-mobile" href="#å·²çŸ¥é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ"><span class="level-left"><span class="level-item">5</span><span class="level-item">å·²çŸ¥é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Service-ç¼ºå°‘-Load-Balancer-IP"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">Service ç¼ºå°‘ Load Balancer IP</span></span></a></li></ul></li><li><a class="level is-mobile" href="#å®è·µæ“ä½œ"><span class="level-left"><span class="level-item">6</span><span class="level-item">å®è·µæ“ä½œ</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Code-Walkthrough/"><span class="level-start"><span class="level-item">Code Walkthrough</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/categories/Getting-Started/"><span class="level-start"><span class="level-item">Getting Started</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/Meetup/"><span class="level-start"><span class="level-item">Meetup</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Overview/"><span class="level-start"><span class="level-item">Overview</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/"><span class="level-start"><span class="level-item">Programming</span></span><span class="level-end"><span class="level-item tag">7</span></span></a><ul><li><a class="level is-mobile" href="/categories/Programming/Elegant-Coding/"><span class="level-start"><span class="level-item">Elegant Coding</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/Quick-Start/"><span class="level-start"><span class="level-item">Quick Start</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></li></ul></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="ğŸ¾Corgi" height="28"></a><p class="is-size-7"><span>&copy; 2023 Shen Xianghong</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p><p class="is-size-7"><br/>And did you get what you wanted from this life, even so?</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><script src="/js/night.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>